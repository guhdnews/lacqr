(()=>{var e={};e.id=496,e.ids=[496],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},89282:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(48209),s(22834),s(13946),s(35866);var a=s(23191),r=s(88716),l=s(37922),n=s.n(l),i=s(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["crm",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,48209)),"C:\\Users\\PHELPS\\Documents\\Lacqr\\src\\app\\dashboard\\crm\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,22834)),"C:\\Users\\PHELPS\\Documents\\Lacqr\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,13946)),"C:\\Users\\PHELPS\\Documents\\Lacqr\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\PHELPS\\Documents\\Lacqr\\src\\app\\dashboard\\crm\\[id]\\page.tsx"],x="/dashboard/crm/[id]/page",h={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/crm/[id]/page",pathname:"/dashboard/crm/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},50824:(e,t,s)=>{Promise.resolve().then(s.bind(s,41885))},58667:(e,t,s)=>{Promise.resolve().then(s.bind(s,34653))},86333:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},24230:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},51896:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},48998:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},71821:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},36283:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},24319:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},77506:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},71810:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},40617:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},42887:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},83855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},31215:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},88378:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1572:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},17069:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},24061:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62881).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},41885:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var a=s(10326),r=s(17577),l=s(35047),n=s(58729),i=s(76),o=s(90445),d=s(86333),c=s(50949),x=s(98091),h=s(94019),u=s(31215),p=s(42887),m=s(5932),g=s(40617),b=s(62881);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,b.Z)("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),f=(0,b.Z)("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);var j=s(17069),v=s(83855),N=s(1572),k=s(24230),w=s(48998);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let S=(0,b.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),C=e=>{let t;if(0===e.length)return{stats:{},lifecycle:{}};let s=e.reduce((e,t)=>e+t.price,0),a=e.length,r=s/a,l="New";if(a>10&&r>50?l="A+":a>5&&r>40?l="A":a>2&&(l="B"),e.length>=2){let s=[...e].sort((e,t)=>t.date.seconds-e.date.seconds),r=1e3*s[0].date.seconds,l=new Date(r+(r-1e3*s[s.length-1].date.seconds)/864e5/(a-1)*864e5);t=i.EK.fromDate(l)}return{stats:{totalSpend:s,visitCount:a,averageTicket:r,clientGrade:l,lastVisitDate:e[0].date},lifecycle:{predictedNextVisit:t}}};var P=s(11552),L=s(60840);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let Z=(0,b.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var q=s(51896),M=s(71821),z=s(77506);function D({isOpen:e,onClose:t,clientId:l,onSuccess:d,initialData:c,serviceId:x}){let{user:u}=(0,n.q)(),{menu:p}=(0,L.H)(),[m,g]=(0,r.useState)("Gel Manicure"),[b,y]=(0,r.useState)("Square"),[f,j]=(0,r.useState)("Short"),[N,k]=(0,r.useState)("Glossy"),[w,S]=(0,r.useState)("None"),[C,D]=(0,r.useState)("None"),[A,H]=(0,r.useState)("None"),[G,E]=(0,r.useState)("None"),[F,U]=(0,r.useState)("None"),[T,_]=(0,r.useState)(""),[$,B]=(0,r.useState)(""),[R,X]=(0,r.useState)(""),[V,O]=(0,r.useState)([]),[I,K]=(0,r.useState)({brand:"",code:"",name:"",category:"Color"}),[W,Q]=(0,r.useState)([]),[J,Y]=(0,r.useState)([]),[ee,et]=(0,r.useState)(!1),es=(0,r.useRef)(null),ea=e=>{O(V.filter((t,s)=>s!==e))},er=async e=>{if(e.preventDefault(),u.id&&l){et(!0);try{let e=[];for(let t of W){let s=(0,P.iH)(o.storage,`users/${u.id}/clients/${l}/${Date.now()}_${t.name}`);await (0,P.KV)(s,t);let a=(0,P.Jt)(s);e.push(await a)}let a=c?[...c.photos?.after||[],...e]:e,r={clientId:l,userId:u.id,date:c?c.date:i.EK.now(),serviceType:m,shape:b,length:f,productsUsed:V,addons:["Glossy"!==N?N:null,"None"!==w?w:null,"None"!==C?C:null,"None"!==A?A:null,"None"!==G?`Bling: ${G}`:null,"None"!==F?F:null].filter(Boolean),price:parseFloat(T)||0,tip:parseFloat($)||0,photos:{after:a},techNotes:R,updatedAt:i.EK.now()};if(x){let{doc:e,updateDoc:t}=await Promise.resolve().then(s.bind(s,76));await t(e(o.db,"service_records",x),r)}else await (0,i.addDoc)((0,i.collection)(o.db,"service_records"),{...r,createdAt:i.EK.now()});d&&d(),t(),x||g("Gel Manicure")}catch(e){console.error("Error logging service:",e),alert("Failed to save service record.")}finally{et(!1)}}};return e?a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",onClick:t,children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-2xl flex flex-col shadow-2xl max-h-[90vh] relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-100 bg-white z-10",children:[a.jsx("h2",{className:"text-2xl font-bold text-charcoal",children:x?"Edit Visit":"Log New Visit"}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(h.Z,{size:20,className:"text-gray-500"})})]}),a.jsx("div",{className:"overflow-y-auto p-6",children:(0,a.jsxs)("form",{onSubmit:er,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Service"}),(0,a.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 bg-gray-50 font-medium",children:[a.jsx("option",{children:"Gel Manicure"}),a.jsx("option",{children:"Acrylic"}),a.jsx("option",{children:"Gel-X"}),a.jsx("option",{children:"Hard Gel"}),a.jsx("option",{children:"Structure Gel"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Shape"}),(0,a.jsxs)("select",{value:b,onChange:e=>y(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 bg-gray-50 font-medium",children:[a.jsx("option",{children:"Square"}),a.jsx("option",{children:"Coffin"}),a.jsx("option",{children:"Almond"}),a.jsx("option",{children:"Stiletto"}),a.jsx("option",{children:"Oval"}),a.jsx("option",{children:"Squoval"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Length"}),(0,a.jsxs)("select",{value:f,onChange:e=>j(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 bg-gray-50 font-medium",children:[a.jsx("option",{children:"Short"}),a.jsx("option",{children:"Medium"}),a.jsx("option",{children:"Long"}),a.jsx("option",{children:"XL"}),a.jsx("option",{children:"XXL"})]})]})]}),(0,a.jsxs)("div",{className:"bg-pink-50 p-4 rounded-xl border border-pink-100",children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-pink-600 mb-3 flex items-center",children:[a.jsx(Z,{size:16,className:"mr-2"}),"Smart Pricing Add-ons"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Finish"}),(0,a.jsxs)("select",{value:N,onChange:e=>k(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("option",{children:"Glossy"}),a.jsx("option",{children:"Matte"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Specialty"}),(0,a.jsxs)("select",{value:w,onChange:e=>S(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("option",{children:"None"}),a.jsx("option",{children:"Chrome"}),a.jsx("option",{children:"Holo"}),a.jsx("option",{children:"Cat Eye"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Design"}),(0,a.jsxs)("select",{value:C,onChange:e=>D(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("option",{children:"None"}),a.jsx("option",{children:"French Tip"}),a.jsx("option",{children:"Ombre"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Art Level"}),(0,a.jsxs)("select",{value:A,onChange:e=>H(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("option",{children:"None"}),a.jsx("option",{children:"Level 1"}),a.jsx("option",{children:"Level 2"}),a.jsx("option",{children:"Level 3"}),a.jsx("option",{children:"Level 4"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Bling"}),(0,a.jsxs)("select",{value:G,onChange:e=>E(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("option",{children:"None"}),a.jsx("option",{children:"Minimal"}),a.jsx("option",{children:"Moderate"}),a.jsx("option",{children:"Heavy"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Foreign Work"}),(0,a.jsxs)("select",{value:F,onChange:e=>U(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("option",{children:"None"}),a.jsx("option",{children:"Foreign Fill"}),a.jsx("option",{children:"Foreign Removal"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-100",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-700 mb-3",children:'Products Used (The "Recipe")'}),(0,a.jsxs)("div",{className:"space-y-2 mb-3",children:[V.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-white p-2 rounded-lg border border-gray-200 text-sm",children:[a.jsx("span",{className:"font-bold text-gray-600 w-16",children:e.category}),(0,a.jsxs)("span",{className:"font-medium text-charcoal flex-1 mx-2",children:[e.brand," ",e.code]}),a.jsx("span",{className:"text-gray-400 text-xs mr-2",children:e.name}),a.jsx("button",{type:"button",onClick:()=>ea(t),className:"text-red-400 hover:text-red-600",children:a.jsx(h.Z,{size:16})})]},t)),0===V.length&&a.jsx("p",{className:"text-xs text-gray-400 italic text-center py-2",children:"No products logged yet."})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-end",children:[a.jsx("div",{className:"w-24",children:a.jsx("input",{placeholder:"Brand",className:"w-full p-2 rounded-lg border border-gray-200 text-sm",value:I.brand,onChange:e=>K({...I,brand:e.target.value})})}),a.jsx("div",{className:"w-20",children:a.jsx("input",{placeholder:"Code",className:"w-full p-2 rounded-lg border border-gray-200 text-sm",value:I.code,onChange:e=>K({...I,code:e.target.value})})}),a.jsx("div",{className:"flex-1",children:a.jsx("input",{placeholder:"Name (Optional)",className:"w-full p-2 rounded-lg border border-gray-200 text-sm",value:I.name,onChange:e=>K({...I,name:e.target.value})})}),a.jsx("button",{type:"button",onClick:()=>{I.brand&&I.code&&(O([...V,{...I}]),K({brand:"",code:"",name:"",category:"Color"}))},className:"bg-charcoal text-white p-2 rounded-lg hover:bg-black transition-colors",children:a.jsx(v.Z,{size:20})})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Result Photos"}),(0,a.jsxs)("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>es.current?.click(),className:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-pink-500 hover:text-pink-500 hover:bg-pink-50 transition-all flex-shrink-0",children:[a.jsx(q.Z,{size:24}),a.jsx("span",{className:"text-xs font-bold mt-1",children:"Add Photo"})]}),a.jsx("input",{type:"file",ref:es,className:"hidden",multiple:!0,accept:"image/*",onChange:e=>{if(e.target.files){let t=Array.from(e.target.files);Q([...W,...t]),Y([...J,...t.map(e=>URL.createObjectURL(e))])}}}),J.map((e,t)=>(0,a.jsxs)("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden border border-gray-200 flex-shrink-0 group",children:[a.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover"}),a.jsx("button",{type:"button",onClick:()=>{Q(W.filter((e,s)=>s!==t)),Y(J.filter((e,s)=>s!==t))},className:"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(h.Z,{size:12})})]},t))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Total Price"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(M.Z,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),a.jsx("input",{type:"number",value:T,onChange:e=>_(e.target.value),className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 font-bold text-lg",placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tip Amount"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(M.Z,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),a.jsx("input",{type:"number",value:$,onChange:e=>B(e.target.value),className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 font-bold text-lg text-green-600",placeholder:"0.00"})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tech Notes"}),a.jsx("textarea",{value:R,onChange:e=>X(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 text-sm h-24",placeholder:"Any issues? Client mood? Special requests?"})]}),a.jsx("div",{className:"pt-2",children:a.jsx("button",{type:"submit",disabled:ee,className:"w-full bg-pink-500 text-white py-4 rounded-xl font-bold hover:bg-pink-600 transition-colors flex items-center justify-center disabled:opacity-70 shadow-lg shadow-pink-200",children:ee?a.jsx(z.Z,{className:"animate-spin mr-2"}):"Save Service Record"})})]})})]})}):null}function A(){let e=(0,l.useParams)(),t=(0,l.useRouter)(),s=e.id,{user:b}=(0,n.q)(),{client:P,history:L,pendingQuotes:Z,notesHistory:q,loading:M,error:z,refresh:A}=function(e,t){let[s,a]=(0,r.useState)({client:null,lastServiceSnapshot:null,history:[],pendingQuotes:[],notesHistory:[],loading:!0,error:null}),l=(0,r.useCallback)(async()=>{if(e&&t)try{let s=(0,i.doc)(o.db,"users",e,"clients",t),r=await (0,i.getDoc)(s);if(!r.exists()){a(e=>({...e,loading:!1,error:"Client not found"}));return}let l={id:r.id,...r.data()},n=(0,i.collection)(o.db,"service_records"),d=(0,i.IO)(n,(0,i.ar)("clientId","==",t),(0,i.Xo)("date","desc")),c=(await (0,i.PL)(d)).docs.map(e=>({id:e.id,...e.data()})),x=[];try{let e=(0,i.collection)(o.db,"quotes"),s=(0,i.IO)(e,(0,i.ar)("clientId","==",t),(0,i.ar)("status","==","pending"),(0,i.Xo)("createdAt","desc"));x=(await (0,i.PL)(s)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.warn("Failed to fetch quotes (likely missing index), continuing without them:",e)}let h=[];try{let s=(0,i.collection)(o.db,"users",e,"clients",t,"notes"),a=(0,i.IO)(s,(0,i.Xo)("createdAt","desc"));h=(await (0,i.PL)(a)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.warn("Failed to fetch notes:",e)}let{stats:u,lifecycle:p}=C(c),m={...l,stats:{...l.stats,...u},lifecycle:{...l.lifecycle,...p}};a({client:m,lastServiceSnapshot:c.length>0?c[0]:null,history:c,pendingQuotes:x,notesHistory:h,loading:!1,error:null})}catch(e){console.error("Error fetching smart profile:",e),a(t=>({...t,loading:!1,error:e.message}))}},[e,t]);return{...s,refresh:l}}(b?.id||void 0,s),[H,G]=(0,r.useState)(!1),[E,F]=(0,r.useState)({}),[U,T]=(0,r.useState)(!1),[_,$]=(0,r.useState)(null),[B,R]=(0,r.useState)(""),[X,V]=(0,r.useState)(!1),O=async()=>{if(B.trim()&&b?.id)try{await (0,i.addDoc)((0,i.collection)(o.db,"users",b.id,"clients",s,"notes"),{content:B,createdAt:new Date,createdBy:"Staff"}),R(""),V(!1),A()}catch(e){console.error("Error adding note:",e),alert("Failed to add note.")}},I=async e=>{if(confirm("Delete this note?")&&b?.id)try{await (0,i.oe)((0,i.doc)(o.db,"users",b.id,"clients",s,"notes",e)),A()}catch(e){console.error("Error deleting note:",e),alert("Failed to delete note.")}},K=async()=>{try{await (0,i.updateDoc)((0,i.doc)(o.db,"clients",s),{name:E.name,phone:E.phone,email:E.email,instagram:E.instagram,notes:E.notes,nailProfile:{bedSize:E.bedSize,cuticleType:E.cuticleType,naturalNailHealth:E.naturalNailHealth,notes:E.nailNotes}}),G(!1),A()}catch(e){console.error("Error updating profile:",e),alert("Failed to update profile.")}},W=async()=>{if(confirm("Are you sure you want to delete this client? This will move them to the trash for 7 days."))try{await (0,i.updateDoc)((0,i.doc)(o.db,"clients",s),{status:"deleted",deletedAt:new Date}),t.push("/dashboard/crm")}catch(e){console.error("Error deleting client:",e),alert("Failed to delete client.")}},Q=async e=>{if(confirm("Are you sure you want to delete this service record?"))try{await (0,i.oe)((0,i.doc)(o.db,"service_records",e)),A()}catch(e){console.error("Error deleting service:",e),alert("Failed to delete service record.")}};return M?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading client profile..."}):z||!P?(0,a.jsxs)("div",{className:"p-8 text-center",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Client not found"}),a.jsx("p",{className:"text-red-500",children:z}),a.jsx("button",{onClick:()=>t.back(),className:"text-pink-500 hover:underline mt-4",children:"Go Back"})]}):(0,a.jsxs)("div",{className:"max-w-5xl mx-auto p-4 space-y-8 pb-20",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>t.back(),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(d.Z,{size:20,className:"text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[H?a.jsx("input",{value:E.name||"",onChange:e=>F({...E,name:e.target.value}),className:"text-3xl font-bold font-serif text-charcoal border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent"}):a.jsx("h1",{className:"text-3xl font-bold font-serif text-charcoal",children:P.name}),P.stats?.clientGrade&&(0,a.jsxs)("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${P.stats.clientGrade.startsWith("A")?"bg-green-100 text-green-700":"B"===P.stats.clientGrade?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:["Grade: ",P.stats.clientGrade]})]}),(0,a.jsxs)("p",{className:"text-gray-500 text-sm flex items-center gap-2",children:["Client since ",P.createdAt?new Date(1e3*P.createdAt.seconds).toLocaleDateString():"Unknown",P.lifecycle?.churnRisk&&(0,a.jsxs)("span",{className:"flex items-center text-red-500 font-bold text-xs",children:[a.jsx(c.Z,{size:12,className:"mr-1"})," At Risk"]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm text-center min-w-[100px]",children:[a.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"LTV"}),(0,a.jsxs)("p",{className:"font-bold text-lg text-green-600",children:["$",(P.stats?.totalSpend||0).toFixed(0)]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm text-center min-w-[100px]",children:[a.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Avg Ticket"}),(0,a.jsxs)("p",{className:"font-bold text-lg text-charcoal",children:["$",(P.stats?.averageTicket||0).toFixed(0)]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm text-center min-w-[100px]",children:[a.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Next Due"}),a.jsx("p",{className:"font-bold text-lg text-blue-600",children:P.lifecycle?.predictedNextVisit?new Date(1e3*P.lifecycle.predictedNextVisit.seconds).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"TBD"})]})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm space-y-4 relative",children:[a.jsx("div",{className:"absolute top-4 right-4 flex space-x-2",children:H?(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:()=>W(),className:"p-1 hover:bg-red-100 rounded text-red-500",title:"Delete Client",children:a.jsx(x.Z,{size:16})}),a.jsx("button",{onClick:()=>G(!1),className:"p-1 hover:bg-gray-100 rounded text-gray-500",children:a.jsx(h.Z,{size:16})}),a.jsx("button",{onClick:K,className:"p-1 hover:bg-green-100 rounded text-green-600",children:a.jsx(u.Z,{size:16})})]}):a.jsx("button",{onClick:()=>G(!0),className:"text-xs text-pink-500 font-bold hover:underline",children:"Edit Profile"})}),a.jsx("h3",{className:"font-bold text-gray-800 mb-2",children:"Contact Details"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-gray-600",children:[a.jsx(p.Z,{size:18,className:"text-pink-500"}),H?a.jsx("input",{value:E.phone||"",onChange:e=>F({...E,phone:e.target.value}),className:"font-medium border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent w-full",placeholder:"Phone"}):a.jsx("p",{className:"font-medium",children:P.phone||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-gray-600",children:[a.jsx(m.Z,{size:18,className:"text-purple-500"}),H?a.jsx("input",{value:E.email||"",onChange:e=>F({...E,email:e.target.value}),className:"font-medium border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent w-full",placeholder:"Email"}):a.jsx("p",{className:"font-medium",children:P.email||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-gray-600",children:[a.jsx(g.Z,{size:18,className:"text-blue-500"}),H?a.jsx("input",{value:E.instagram||"",onChange:e=>F({...E,instagram:e.target.value}),className:"font-medium border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent w-full",placeholder:"Instagram"}):a.jsx("p",{className:"font-medium",children:P.instagram||"N/A"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsx("h3",{className:"font-bold text-gray-800",children:"Nail Profile"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500 flex items-center",children:[a.jsx(y,{size:14,className:"mr-2"})," Bed Size"]}),H?(0,a.jsxs)("select",{value:E.bedSize||"Unknown",onChange:e=>F({...E,bedSize:e.target.value}),className:"text-right border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent",children:[a.jsx("option",{children:"Small"}),a.jsx("option",{children:"Medium"}),a.jsx("option",{children:"Large"}),a.jsx("option",{children:"Unknown"})]}):a.jsx("span",{className:"font-medium",children:P.nailProfile?.bedSize||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500 flex items-center",children:[a.jsx(f,{size:14,className:"mr-2"})," Cuticle"]}),H?(0,a.jsxs)("select",{value:E.cuticleType||"Unknown",onChange:e=>F({...E,cuticleType:e.target.value}),className:"text-right border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent",children:[a.jsx("option",{children:"Dry"}),a.jsx("option",{children:"Oily"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Unknown"})]}):a.jsx("span",{className:"font-medium",children:P.nailProfile?.cuticleType||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500 flex items-center",children:[a.jsx(j.Z,{size:14,className:"mr-2"})," Health"]}),H?(0,a.jsxs)("select",{value:E.naturalNailHealth||"Unknown",onChange:e=>F({...E,naturalNailHealth:e.target.value}),className:"text-right border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent",children:[a.jsx("option",{children:"Strong"}),a.jsx("option",{children:"Brittle"}),a.jsx("option",{children:"Peeling"}),a.jsx("option",{children:"Bitten"}),a.jsx("option",{children:"Unknown"})]}):a.jsx("span",{className:`font-medium ${P.nailProfile?.naturalNailHealth==="Strong"?"text-green-600":P.nailProfile?.naturalNailHealth==="Brittle"?"text-amber-600":"text-gray-800"}`,children:P.nailProfile?.naturalNailHealth||"Unknown"})]})]}),(H||P.nailProfile?.notes)&&a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-50 text-sm text-gray-600 italic",children:H?a.jsx("textarea",{value:E.nailNotes||"",onChange:e=>F({...E,nailNotes:e.target.value}),className:"w-full p-2 border rounded-lg text-sm",placeholder:"Notes..."}):(0,a.jsxs)(a.Fragment,{children:['"',P.nailProfile?.notes,'"']})})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"font-bold text-xl text-charcoal",children:"Service History"}),(0,a.jsxs)("button",{onClick:()=>{$(null),T(!0)},className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-600 transition-colors flex items-center gap-2",children:[a.jsx(v.Z,{size:16})," Log Visit"]})]}),Z&&Z.length>0&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 p-6 rounded-3xl border border-pink-100",children:[(0,a.jsxs)("h4",{className:"font-bold text-pink-800 mb-4 flex items-center gap-2",children:[a.jsx(N.Z,{size:18})," Pending Quotes"]}),a.jsx("div",{className:"space-y-3",children:Z.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl border border-pink-100 shadow-sm flex justify-between items-center group hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-bold text-gray-800",children:[e.data?.base?.system||"Custom Set"," - ",e.data?.base?.length||"Medium"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[(0,a.jsxs)("span",{className:"font-medium text-pink-600",children:["$",e.totalPrice]}),a.jsx("span",{children:"•"}),a.jsx("span",{children:new Date(1e3*e.createdAt.seconds).toLocaleDateString()})]})]}),(0,a.jsxs)("button",{onClick:()=>{$({...e,price:e.totalPrice,serviceType:`${e.data?.base?.system} ${e.data?.base?.shape} Set`,notes:`Based on Lacqr Lens Scan:
- Length: ${e.data?.base?.length}
- Art Level: ${e.data?.art?.level}
- Addons: ${e.data?.addons?.specialtyEffect}`}),T(!0)},className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-600 transition-colors flex items-center gap-2",children:["Book ",a.jsx(k.Z,{size:14})]})]},e.id))})]}),0===L.length?a.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-3xl border border-dashed border-gray-200",children:a.jsx("p",{className:"text-gray-500",children:"No history found. Log their first visit!"})}):a.jsx("div",{className:"space-y-3",children:L.map(e=>a.jsx("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"w-16 h-16 bg-pink-50 rounded-xl flex flex-col items-center justify-center text-pink-500 font-bold leading-none shadow-sm",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:e.date?new Date(1e3*e.date.seconds).toLocaleDateString("en-US",{month:"short"}):""}),a.jsx("span",{className:"text-2xl my-0.5",children:e.date?new Date(1e3*e.date.seconds).getDate():"?"}),a.jsx("span",{className:"text-[10px] text-pink-400",children:e.date?new Date(1e3*e.date.seconds).getFullYear():""})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-bold text-charcoal text-lg",children:e.serviceType}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(w.Z,{size:12}),e.date?new Date(1e3*e.date.seconds).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):""]}),e.addons&&e.addons.length>0&&(0,a.jsxs)("span",{children:["• + ",e.addons.join(", ")]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-bold text-lg",children:["$",e.price]}),e.tip>0&&(0,a.jsxs)("p",{className:"text-xs text-green-600 font-medium",children:["+$",e.tip," tip"]}),(0,a.jsxs)("div",{className:"flex space-x-2 justify-end mt-2",children:[a.jsx("button",{onClick:()=>{$(e),T(!0)},className:"text-gray-300 hover:text-blue-500 transition-colors",title:"Edit Record",children:a.jsx(S,{size:16})}),a.jsx("button",{onClick:()=>Q(e.id),className:"text-gray-300 hover:text-red-500 transition-colors",title:"Delete Record",children:a.jsx(x.Z,{size:16})})]})]})]})},e.id))}),(0,a.jsxs)("div",{className:"space-y-4 pt-8 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"font-bold text-xl text-charcoal flex items-center gap-2",children:[a.jsx(g.Z,{size:20,className:"text-yellow-500"}),"Client Notes History"]}),a.jsx("button",{onClick:()=>V(!X),className:"text-pink-500 font-bold text-sm hover:underline",children:X?"Cancel":"+ Add Note"})]}),X&&(0,a.jsxs)("div",{className:"bg-white p-4 rounded-2xl border border-pink-100 shadow-sm animate-in fade-in slide-in-from-top-2",children:[a.jsx("textarea",{value:B,onChange:e=>R(e.target.value),className:"w-full p-3 border border-gray-200 rounded-xl text-sm focus:border-pink-500 outline-none min-h-[100px]",placeholder:"Write a note about this client...",autoFocus:!0}),a.jsx("div",{className:"flex justify-end mt-2",children:a.jsx("button",{onClick:O,disabled:!B.trim(),className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold text-sm hover:bg-pink-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Note"})})]}),a.jsx("div",{className:"space-y-3",children:q&&q.length>0?q.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow group",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"text-gray-700 whitespace-pre-wrap flex-1",children:e.content}),a.jsx("button",{onClick:()=>I(e.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity ml-2",title:"Delete Note",children:a.jsx(x.Z,{size:14})})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-400",children:[a.jsx("span",{children:e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString():"Unknown Date"}),a.jsx("span",{children:"•"}),a.jsx("span",{children:e.createdBy||"Staff"})]})]},e.id)):a.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:a.jsx("p",{className:"text-gray-400 text-sm",children:"No notes yet. Add one to keep track of preferences!"})})})]})]})]}),a.jsx(D,{isOpen:U,onClose:()=>T(!1),clientId:s,onSuccess:A,initialData:_,serviceId:_?.id})]})}},34653:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(10326),r=s(17577),l=s(35047),n=s(58729),i=s(90434),o=s(24319),d=s(51896),c=s(40617),x=s(36283),h=s(24061),u=s(88378),p=s(94019),m=s(90748),g=s(71810);function b(){let e=(0,l.usePathname)(),t=(0,l.useRouter)(),{setUser:b}=(0,n.q)(),[y,f]=(0,r.useState)(!1),j=t=>e===t,v=async()=>{try{let{auth:e}=await Promise.resolve().then(s.bind(s,90445));await e.signOut(),b({id:null,name:null,email:null,isAuthenticated:!1,onboardingComplete:!1}),t.push("/")}catch(e){console.error("Logout failed",e)}},N=[{path:"/dashboard",label:"Dashboard",icon:o.Z},{path:"/dashboard/lacqr-lens",label:"Lacqr Lens",icon:d.Z},{path:"/dashboard/smart-quote",label:"Smart Quote",icon:c.Z},{path:"/dashboard/service-menu",label:"Service Menu",icon:x.Z},{path:"/dashboard/crm",label:"CRM",icon:h.Z},{path:"/dashboard/settings",label:"Settings",icon:u.Z}];return(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"md:hidden fixed top-0 left-0 right-0 h-16 bg-white border-b border-pink-50 z-50 flex items-center px-4 justify-between shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>f(!y),className:"p-2 text-charcoal hover:bg-gray-100 rounded-lg transition-colors",children:y?a.jsx(p.Z,{size:24}):a.jsx(m.Z,{size:24})}),a.jsx("span",{className:"text-xl font-serif font-bold text-charcoal",children:"Lacqr"})]})}),(0,a.jsxs)("aside",{className:`
                fixed inset-y-0 left-0 z-40 w-64 bg-white border-r border-pink-50 transform transition-transform duration-300 ease-in-out flex flex-col
                ${y?"translate-x-0":"-translate-x-full md:translate-x-0"}
            `,children:[a.jsx("div",{className:"p-6 border-b border-pink-50",children:a.jsx(i.default,{href:"/dashboard",className:"text-2xl font-serif font-bold tracking-tight text-charcoal",children:"Lacqr"})}),a.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:N.map(e=>(0,a.jsxs)(i.default,{href:e.path,onClick:()=>f(!1),className:`
                                flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200
                                ${j(e.path)?"bg-pink-50 text-pink-600 font-medium shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-charcoal"}
                            `,children:[a.jsx(e.icon,{size:20,className:j(e.path)?"text-pink-500":"text-gray-400"}),a.jsx("span",{children:e.label})]},e.path))}),(0,a.jsxs)("div",{className:"p-4 border-t border-pink-50 space-y-1",children:[(0,a.jsxs)("a",{href:"https://lacqr.io",className:"flex items-center space-x-3 px-4 py-3 w-full text-left text-gray-500 hover:bg-gray-50 hover:text-charcoal rounded-xl transition-colors",children:[a.jsx(g.Z,{size:20,className:"rotate-180"}),a.jsx("span",{children:"Back to Website"})]}),(0,a.jsxs)("button",{onClick:v,className:"flex items-center space-x-3 px-4 py-3 w-full text-left text-gray-500 hover:bg-red-50 hover:text-red-600 rounded-xl transition-colors",children:[a.jsx(g.Z,{size:20}),a.jsx("span",{children:"Log Out"})]})]})]}),y&&a.jsx("div",{className:"md:hidden fixed inset-0 z-30 bg-black/20 backdrop-blur-sm",onClick:()=>f(!1)})]})}function y({children:e}){(0,l.useRouter)(),(0,l.usePathname)();let{user:t,isAuthReady:s}=(0,n.q)();return s?t&&t.isAuthenticated?(0,a.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[a.jsx(b,{}),a.jsx("div",{className:"flex-1 md:ml-64 pt-16 md:pt-0",children:e})]}):null:a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})}},60840:(e,t,s)=>{"use strict";s.d(t,{H:()=>n});var a=s(68408),r=s(85251),l=s(9791);let n=(0,a.U)()((0,r.tJ)(e=>({menu:l.p,updateBasePrice:(t,s)=>e(e=>({menu:{...e.menu,basePrices:{...e.menu.basePrices,[t]:s}}})),updateLengthSurcharge:(t,s)=>e(e=>({menu:{...e.menu,lengthSurcharges:{...e.menu.lengthSurcharges,[t]:s}}})),updateFinishSurcharge:(t,s)=>e(e=>({menu:{...e.menu,finishSurcharges:{...e.menu.finishSurcharges,[t]:s}}})),updateSpecialtySurcharge:(t,s)=>e(e=>({menu:{...e.menu,specialtySurcharges:{...e.menu.specialtySurcharges,[t]:s}}})),updateClassicDesignSurcharge:(t,s)=>e(e=>({menu:{...e.menu,classicDesignSurcharges:{...e.menu.classicDesignSurcharges,[t]:s}}})),updateArtLevelPrice:(t,s)=>e(e=>({menu:{...e.menu,artLevelPrices:{...e.menu.artLevelPrices,[t]:s}}})),updateBlingDensityPrice:(t,s)=>e(e=>({menu:{...e.menu,blingDensityPrices:{...e.menu.blingDensityPrices,[t]:s}}})),updateUnitPrice:(t,s)=>e(e=>({menu:{...e.menu,unitPrices:{...e.menu.unitPrices,[t]:s}}})),updateModifierSurcharge:(t,s)=>e(e=>({menu:{...e.menu,modifierSurcharges:{...e.menu.modifierSurcharges,[t]:s}}})),updatePedicurePrice:(t,s)=>e(e=>({menu:{...e.menu,pedicurePrices:{...e.menu.pedicurePrices,[t]:s}}})),resetMenu:()=>e({menu:l.p})}),{name:"lacqr-service-menu-v2"}))},9791:(e,t,s)=>{"use strict";s.d(t,{p:()=>a});let a={basePrices:{Acrylic:55,"Gel-X":65,"Hard Gel":60,"Structure Gel":50},fillPrices:{Acrylic:45,"Gel-X":55,"Hard Gel":50,"Structure Gel":40},lengthSurcharges:{Short:0,Medium:5,Long:10,XL:15,XXL:20},shapeSurcharges:{Square:0,Squoval:0,Coffin:0,Almond:5,Stiletto:5,Ballerina:5,Lipstick:5,Duck:10},finishSurcharges:{Glossy:0,Matte:5},specialtySurcharges:{None:0,Chrome:15,Holo:15,"Cat Eye":15},classicDesignSurcharges:{None:0,"French Tip":15,Ombre:15},artLevelPrices:{"Level 1":10,"Level 2":25,"Level 3":45,"Level 4":70},blingDensityPrices:{None:0,Minimal:10,Moderate:25,Heavy:50},unitPrices:{xlCharms:5,piercings:5,repairs:5,soakOff:20},modifierSurcharges:{None:0,"Foreign Fill":15,"Foreign Removal":25},pedicurePrices:{None:0,Classic:35,Gel:50,"Acrylic Toe Set":65},durations:{base:{Acrylic:60,"Gel-X":45,"Hard Gel":60,"Structure Gel":45},fill:{Acrylic:45,"Gel-X":45,"Hard Gel":45,"Structure Gel":30},length:{Short:0,Medium:15,Long:30,XL:60,XXL:90},shape:{Square:0,Squoval:0,Coffin:0,Almond:0,Stiletto:0,Ballerina:0,Lipstick:0,Duck:30},art:{"Level 1":15,"Level 2":30,"Level 3":60,"Level 4":120},bling:{None:0,Minimal:15,Moderate:30,Heavy:60},pedicure:{None:0,Classic:30,Gel:45,"Acrylic Toe Set":60},removal:30}}},48209:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var a=s(68570);let r=(0,a.createProxy)(String.raw`C:\Users\PHELPS\Documents\Lacqr\src\app\dashboard\crm\[id]\page.tsx`),{__esModule:l,$$typeof:n}=r;r.default;let i=(0,a.createProxy)(String.raw`C:\Users\PHELPS\Documents\Lacqr\src\app\dashboard\crm\[id]\page.tsx#default`)},22834:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var a=s(68570);let r=(0,a.createProxy)(String.raw`C:\Users\PHELPS\Documents\Lacqr\src\app\dashboard\layout.tsx`),{__esModule:l,$$typeof:n}=r;r.default;let i=(0,a.createProxy)(String.raw`C:\Users\PHELPS\Documents\Lacqr\src\app\dashboard\layout.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,707,573],()=>s(89282));module.exports=a})();