(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6601],{29601:function(e,t,s){Promise.resolve().then(s.bind(s,67346))},67346:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var a=s(57437),l=s(2265),n=s(16463),r=s(74697),i=s(99687),o=s(98039),c=s(33907),d=s(80233),x=s(66706),m=s(71568),u=s(10462),g=s(13231),h=s(71976),b=s(95137),p=s(78233),f=s(39134),j=s(69842),y=s(89506),N=s(23700),v=s(22682),w=s(98714),k=s(53371),S=s(43257),C=s(60479),z=s(11925),_=s(22468),Z=s(37164),q=s(81173),D=s.n(q),I=s(97501);function P(e){var t;let{initialSelection:s,onSaveDraft:n,onAssignClient:r,onCreateClient:i}=e,{menu:o}=(0,k.H)(),{user:c}=(0,S.q)(),[d]=(0,l.useState)(s),[x,m]=(0,l.useState)(!1);if(!d||!d.base)return(0,a.jsxs)("div",{className:"p-8 text-center text-red-500",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Error: Invalid Quote Data"}),(0,a.jsx)("p",{children:"Please retake the scan."})]});let u=(0,z.e_)(d,o),g=async()=>{let e=document.getElementById("receipt-print-view");if(e)try{let t=await D()(e,{scale:2,backgroundColor:"#ffffff",logging:!1}),s=t.toDataURL("image/png"),a=new I.ZP({orientation:"portrait",unit:"mm",format:"a4"}),l=210*t.height/t.width;a.addImage(s,"PNG",0,0,210,l),a.save("Lacqr-Receipt-".concat(new Date().toISOString().split("T")[0],".pdf"))}catch(e){console.error("PDF Generation failed:",e),alert("Failed to generate PDF. Please try again.")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gray-900 p-6 text-white flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Receipt Preview"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Review final details before saving"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-3xl font-black",children:["$",u.total]}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Estimated Total"})]})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-gray-900 block",children:d.base.system}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[d.base.length," / ",d.base.shape]})]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",u.breakdown.base+u.breakdown.length+u.breakdown.shape]})]}),d.art.level&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:["Art Level: ",d.art.level]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",u.breakdown.art]})]}),u.breakdown.bling>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:["Bling","None"!==d.bling.density?": ".concat(d.bling.density):""]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",u.breakdown.bling]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[(0,a.jsxs)("button",{onClick:()=>m(!0),className:"bg-charcoal text-white py-3 rounded-xl font-bold hover:bg-black transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(_.Z,{size:18}),(0,a.jsx)("span",{children:"Save Quote"})]}),(0,a.jsxs)("button",{onClick:g,className:"border border-gray-200 text-gray-700 py-3 rounded-xl font-bold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(Z.Z,{size:18}),(0,a.jsx)("span",{children:"Download PDF"})]})]})]}),x&&(0,a.jsx)("div",{className:"absolute inset-0 bg-white/90 backdrop-blur-sm flex items-center justify-center p-6 z-10 animate-in fade-in",children:(0,a.jsxs)("div",{className:"bg-white shadow-2xl rounded-2xl p-6 w-full max-w-sm border border-gray-100 space-y-3",children:[(0,a.jsx)("h3",{className:"font-bold text-center text-lg mb-4",children:"Save Quote To..."}),(0,a.jsx)("button",{onClick:r,className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-900 rounded-lg transition-colors font-medium",children:"Existing Client"}),(0,a.jsx)("button",{onClick:i,className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-900 rounded-lg transition-colors font-medium",children:"New Client"}),(0,a.jsx)("button",{onClick:()=>n(d),className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-900 rounded-lg transition-colors font-medium",children:"Save as Draft"}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"w-full text-center text-sm text-gray-500 hover:text-gray-700 py-2 mt-2",children:"Cancel"})]})})]}),(0,a.jsxs)("div",{id:"receipt-print-view",className:"fixed -left-[9999px] top-0 w-[800px] bg-white p-12 text-gray-900 font-sans",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-5xl font-black text-gray-900 tracking-tighter mb-2 uppercase",children:(null==c?void 0:c.salonName)||(null==c?void 0:c.name)||"LACQR"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 uppercase tracking-widest",children:"Premium Nail Service"})]}),(0,a.jsxs)("div",{className:"border-t-2 border-b-2 border-gray-900 py-8 mb-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("span",{className:"font-bold text-xl text-gray-900",children:"Date"}),(0,a.jsx)("span",{className:"font-mono text-lg text-gray-600",children:new Date().toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-bold text-xl text-gray-900",children:"Time"}),(0,a.jsx)("span",{className:"font-mono text-lg text-gray-600",children:new Date().toLocaleTimeString()})]})]}),(0,a.jsxs)("div",{className:"space-y-6 mb-12",children:[(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-2xl text-gray-900 block",children:d.base.system}),(0,a.jsxs)("span",{className:"text-lg text-gray-500",children:[d.base.isFill?"Fill In":"Full Set"," - ",d.base.length," / ",d.base.shape]})]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-2xl",children:["$",u.breakdown.base+u.breakdown.length+u.breakdown.shape]})]}),d.art.level&&(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("span",{className:"font-medium text-xl text-gray-700",children:["Art Level: ",d.art.level]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",u.breakdown.art]})]}),u.breakdown.bling>0&&(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("span",{className:"font-medium text-xl text-gray-700",children:["Bling","None"!==d.bling.density?": ".concat(d.bling.density):""]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",u.breakdown.bling]})]}),null===(t=d.extras)||void 0===t?void 0:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsx)("span",{className:"font-medium text-xl text-gray-700",children:e.name}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",e.price]})]},t))]}),(0,a.jsxs)("div",{className:"border-t-4 border-gray-900 pt-8 flex justify-between items-end mb-16",children:[(0,a.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:"Total"}),(0,a.jsxs)("span",{className:"text-6xl font-black text-gray-900",children:["$",u.total]})]}),(0,a.jsxs)("div",{className:"text-center text-gray-400 space-y-2 mt-auto",children:[(0,a.jsxs)("p",{className:"text-lg font-medium text-gray-900",children:["Thank you for choosing ",(null==c?void 0:c.salonName)||(null==c?void 0:c.name)||"us","."]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-8 pt-8 border-t border-gray-100",children:[(0,a.jsx)("span",{className:"text-xs uppercase tracking-widest text-gray-400",children:"Powered by"}),(0,a.jsx)("span",{className:"font-black text-sm text-pink-600 uppercase tracking-widest",children:"LACQR"})]})]})]})]})}var E=s(77907),A=s(18866);function R(){let{menu:e}=(0,k.H)(),t=(0,n.useSearchParams)(),_=(0,n.useRouter)(),[Z,q]=(0,l.useState)(()=>localStorage.getItem("lacqr_lens_image")),[D,I]=(0,l.useState)(!1),[R,F]=(0,l.useState)(()=>{{let e=localStorage.getItem("lacqr_lens_result");return e?JSON.parse(e):null}}),[L,O]=(0,l.useState)(!1),[T,$]=(0,l.useState)(1),[J,Q]=(0,l.useState)(!1),[U,G]=(0,l.useState)(!1),[B,H]=(0,l.useState)(()=>localStorage.getItem("lacqr_lens_step")||"scan"),[W,X]=(0,l.useState)("design"),[M,Y]=(0,l.useState)([]),[K,V]=(0,l.useState)(!1),{user:ee}=(0,S.q)();(0,l.useEffect)(()=>{(async()=>{if(null==ee?void 0:ee.id)try{let e=(0,j.IO)((0,j.collection)(y.db,"quotes"),(0,j.ar)("userId","==",ee.id),(0,j.Xo)("createdAt","desc"),(0,j.b9)(5)),t=(await (0,j.PL)(e)).docs.map(e=>({id:e.id,...e.data()}));Y(t)}catch(e){console.error("Error fetching history:",e)}})()},[null==ee?void 0:ee.id,B]),(0,l.useEffect)(()=>{try{Z?localStorage.setItem("lacqr_lens_image",Z):localStorage.removeItem("lacqr_lens_image")}catch(e){console.warn("Failed to save image to localStorage (likely quota exceeded):",e)}},[Z]),(0,l.useEffect)(()=>{R?localStorage.setItem("lacqr_lens_result",JSON.stringify(R)):localStorage.removeItem("lacqr_lens_result")},[R]),(0,l.useEffect)(()=>{localStorage.setItem("lacqr_lens_step",B)},[B]),(0,l.useEffect)(()=>{let e=t.get("draftId");e&&(et(e),_.replace("/dashboard/lacqr-lens"))},[t,_]),(0,l.useEffect)(()=>{"receipt"!==B||R&&R.base||(console.warn("Invalid state for receipt (missing result), resetting to scan."),H("scan"))},[B,R]);let et=async e=>{try{let t=await (0,j.getDoc)((0,j.doc)(y.db,"quotes",e));if(t.exists()){let e=t.data();F(e.data),H("configure"),q(null),V(!1)}}catch(e){console.error("Error loading draft:",e)}},[es,ea]=(0,l.useState)(!1),[el,en]=(0,l.useState)("create"),[er,ei]=(0,l.useState)(!1),{isCoolingDown:eo,remainingTime:ec,startCooldown:ed}=(0,v.q)({cooldownTime:1e4,key:"lacqr_lens_scan"}),[ex,em]=(0,l.useState)(null),eu=l.useRef(null),eg=async e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(eu.current&&(eu.current.value=""),eo){alert("Please wait ".concat(ec,"s before scanning again."));return}if(s){let e=new FileReader;e.onloadend=async()=>{let t=e.result;q(t),O(await (0,f.Ok)(t))},e.readAsDataURL(s),I(!0),F(null),em(null),H("scan");try{let e=await (0,f.hv)(s),t=await p.Go.analyzeImage(e,W);F(t),H("configure"),ed()}catch(e){console.error("Analysis failed",e),em(e.message||"An unexpected error occurred.")}finally{I(!1)}}},eh=()=>{D||(q(null),F(null),I(!1),O(!1),$(1),H("scan"),localStorage.removeItem("lacqr_lens_image"),localStorage.removeItem("lacqr_lens_result"),localStorage.removeItem("lacqr_lens_step"))},eb=async t=>{if(!ee.isAuthenticated||!ee.id){alert("Please log in to save drafts.");return}try{let{addDoc:a,collection:l}=await Promise.resolve().then(s.bind(s,69842)),{db:n}=await Promise.resolve().then(s.bind(s,89506)),r=new Date;r.setDate(r.getDate()+14);let i=(e=>{let t=JSON.parse(JSON.stringify(e));return t.modalResult&&delete t.modalResult,t})(t);await a(l(n,"quotes"),{userId:ee.id,status:"draft",data:i,createdAt:new Date,expiresAt:r,salonName:ee.name||"My Salon",totalPrice:(0,z.e_)(t,e).total}),alert("Draft saved! It will be kept for 14 days.")}catch(e){console.error("Error saving draft:",e),alert("Failed to save draft: ".concat(e.message))}},ep=async t=>{if(R&&ee)try{let s=JSON.parse(JSON.stringify(R));s.modalResult&&delete s.modalResult;let a=(0,z.e_)(R,e).total;await (0,j.addDoc)((0,j.collection)(y.db,"quotes"),{type:"assigned",data:s,totalPrice:a,createdAt:new Date,salonName:ee.name||"Your Salon",userId:ee.id,clientId:t.id,clientName:t.name,status:"pending"}),alert("Quote saved for ".concat(t.name,"!"))}catch(e){console.error("Error saving quote:",e),alert("Failed to save quote.")}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,a.jsxs)("div",{className:"flex flex-col max-w-2xl mx-auto relative bg-white rounded-[2.5rem] shadow-xl overflow-hidden border-4 border-pink-100 my-4 transition-all duration-500",children:[(0,a.jsxs)("div",{className:"p-6 z-10 space-y-6 bg-gradient-to-b from-pink-50 to-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("button",{onClick:()=>_.back(),className:"p-2 bg-white border border-pink-100 rounded-full text-gray-500 hover:text-pink-600 hover:border-pink-300 transition-all shadow-sm",children:(0,a.jsx)(r.Z,{size:24})}),(0,a.jsx)("h2",{className:"text-pink-900 font-bold text-lg tracking-wide",children:"Lacqr Lens"}),(0,a.jsx)("button",{onClick:()=>Q(!0),className:"p-2 bg-white border border-pink-100 rounded-full text-gray-500 hover:text-pink-600 hover:border-pink-300 transition-all shadow-sm",children:(0,a.jsx)(i.Z,{size:24})})]}),(0,a.jsxs)("div",{className:"bg-gray-100 p-1.5 rounded-2xl flex relative shadow-inner",children:[(0,a.jsx)("div",{className:"absolute top-1.5 bottom-1.5 w-[calc(50%-6px)] bg-white rounded-xl shadow-md transition-all duration-300 ease-out ".concat("diagnostics"===W?"left-1.5":"left-[calc(50%+6px)]")}),(0,a.jsxs)("button",{onClick:()=>X("diagnostics"),className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl relative z-10 transition-colors duration-300 ".concat("diagnostics"===W?"text-pink-600 font-bold":"text-gray-500 font-medium hover:text-gray-700"),children:[(0,a.jsx)(o.Z,{size:18}),(0,a.jsx)("span",{children:"Assess Hand"})]}),(0,a.jsxs)("button",{onClick:()=>X("design"),className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl relative z-10 transition-colors duration-300 ".concat("design"===W?"text-purple-600 font-bold":"text-gray-500 font-medium hover:text-gray-700"),children:[(0,a.jsx)(c.Z,{size:18}),(0,a.jsx)("span",{children:"Analyze Inspo"})]})]})]}),(0,a.jsxs)("div",{className:"relative mx-4 mb-4 rounded-3xl overflow-hidden bg-gray-50 border-2 border-dashed border-pink-200 group min-h-[400px]",children:[Z&&(0,a.jsx)("img",{src:Z,alt:"Captured",className:"w-full h-full object-cover absolute inset-0 transition-opacity duration-500 ".concat(D?"opacity-50 blur-sm":"opacity-100")}),(D||!Z)&&(0,a.jsx)("div",{className:"absolute inset-0 z-20 pointer-events-none",children:(0,a.jsx)(N.Z,{isScanning:D,mode:W})}),!D&&!Z&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-30 pointer-events-none gap-8",children:[(0,a.jsx)("div",{className:"text-center px-8 max-w-md animate-in fade-in slide-in-from-bottom-4 duration-700",children:(0,a.jsx)("p",{className:"text-gray-500 text-lg font-medium",children:"diagnostics"===W?"Point camera at client's hand to detect regrowth and repairs.":"Upload photo to match colors and calculate design price."})}),(0,a.jsxs)("div",{className:"relative group pointer-events-auto",children:[(0,a.jsx)("div",{className:"absolute -inset-4 bg-gradient-to-r from-pink-200 to-purple-200 rounded-full blur-xl opacity-50 group-hover:opacity-75 transition duration-1000 group-hover:duration-200 animate-pulse"}),(0,a.jsxs)("label",{className:"relative w-32 h-32 bg-white rounded-full flex flex-col items-center justify-center cursor-pointer hover:scale-105 transition-transform shadow-[0_8px_30px_rgb(0,0,0,0.12)] border-4 border-pink-50",children:[(0,a.jsx)(d.Z,{size:40,className:"text-pink-500 mb-2"}),(0,a.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-gray-400",children:"Tap to Scan"}),(0,a.jsx)("input",{ref:eu,type:"file",accept:"image/*",className:"hidden",onChange:eg})]})]})]}),Z&&!D&&(0,a.jsx)("button",{onClick:()=>{eh()},className:"absolute top-4 right-4 p-2 bg-white/80 backdrop-blur-md rounded-full text-gray-700 hover:text-red-500 transition-all shadow-sm z-50",children:(0,a.jsx)(x.Z,{size:20})})]}),!Z&&(0,a.jsx)("div",{className:"flex justify-center pb-6",children:(0,a.jsxs)("button",{onClick:()=>V(!0),className:"text-gray-400 hover:text-pink-500 flex items-center gap-2 text-sm font-medium transition-colors",children:[(0,a.jsx)(m.Z,{size:16})," Recent Scans"]})}),K&&(0,a.jsxs)("div",{className:"absolute inset-0 bg-white/95 backdrop-blur-sm z-50 p-6 animate-in slide-in-from-bottom-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-gray-800 font-bold text-xl",children:"Recent Scans"}),(0,a.jsx)("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(r.Z,{size:24})})]}),(0,a.jsx)("div",{className:"space-y-4",children:M.map(e=>{var t;return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-100 p-4 rounded-xl flex gap-4 items-center cursor-pointer hover:bg-pink-50 hover:border-pink-100 transition-all",onClick:()=>et(e.id),children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-white rounded-lg overflow-hidden flex items-center justify-center text-pink-200 border border-gray-100 shadow-sm",children:(0,a.jsx)(o.Z,{size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-800 font-bold",children:e.clientName||"Unknown Client"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:new Date((null===(t=e.createdAt)||void 0===t?void 0:t.seconds)*1e3).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"ml-auto font-bold text-pink-500",children:["$",e.totalPrice]})]},e.id)})})]})]}),R&&!D&&(0,a.jsxs)("div",{className:"max-w-2xl mx-auto px-4 space-y-6 animate-in slide-in-from-bottom-8 duration-700",children:[R.visual_description&&(0,a.jsxs)("div",{className:"bg-gradient-to-br from-gray-900 to-black text-white p-6 rounded-3xl shadow-xl border border-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4 text-pink-400",children:[(0,a.jsx)(u.Z,{size:24}),(0,a.jsx)("h3",{className:"font-bold text-base uppercase tracking-wider",children:"AI Analysis"})]}),(0,a.jsxs)("p",{className:"text-gray-300 leading-relaxed italic text-lg",children:['"',R.visual_description,'"']})]}),(0,a.jsxs)("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"p-3 rounded-2xl ".concat("diagnostics"===W?"bg-blue-50 text-blue-600":"bg-purple-50 text-purple-600"),children:"diagnostics"===W?(0,a.jsx)(o.Z,{size:24}):(0,a.jsx)(c.Z,{size:24})}),(0,a.jsx)("h2",{className:"font-bold text-xl text-charcoal",children:"diagnostics"===W?"Required Prep":"Design Elements"})]}),(0,a.jsx)("div",{className:"space-y-3",children:"diagnostics"===W?(0,a.jsxs)(a.Fragment,{children:["None"!==R.modifiers.foreignWork&&(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:R.modifiers.foreignWork}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]}),R.modifiers.repairsCount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:[R.modifiers.repairsCount," Nail Repair(s)"]}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]}),R.extras&&R.extras.length>0?R.extras.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:e.name}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]},t)):"None"===R.modifiers.foreignWork&&0===R.modifiers.repairsCount&&(0,a.jsx)("p",{className:"text-gray-400 text-sm italic text-center py-2",children:"No major issues detected. Ready for prep!"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:[R.base.shape," Shape"]}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:[R.base.length," Length"]}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]}),R.art.level&&"Level 1"!==R.art.level&&(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:[R.art.level," Art"]}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]}),"None"!==R.addons.specialtyEffect&&(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-2xl",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:R.addons.specialtyEffect}),(0,a.jsx)(g.Z,{size:20,className:"text-green-500"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100",children:[(0,a.jsx)("h2",{className:"font-bold text-xl text-charcoal mb-6",children:"Fine Tune Quote"}),(0,a.jsx)(C.Z,{initialSelection:R,onUpdate:e=>F(e)})]}),(0,a.jsx)("div",{className:"flex gap-4 pt-4 pb-12",children:(0,a.jsxs)("button",{onClick:()=>H("receipt"),className:"flex-1 bg-pink-500 text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-pink-200 hover:bg-pink-600 transition-all flex items-center justify-center gap-2",children:["Generate Receipt ",(0,a.jsx)(h.Z,{size:20})]})})]}),"receipt"===B&&R&&R.base&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-gray-50 overflow-y-auto animate-in slide-in-from-bottom-full duration-500",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto min-h-screen p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)("button",{onClick:()=>H("scan"),className:"p-2 bg-white border border-gray-200 rounded-full text-gray-500 hover:text-black transition-all",children:(0,a.jsx)(b.Z,{size:24})}),(0,a.jsx)("h2",{className:"font-bold text-xl",children:"Final Receipt"})]}),(0,a.jsx)(P,{initialSelection:R,onSaveDraft:eb,onAssignClient:()=>{en("assign"),ea(!0)},onCreateClient:()=>{en("create"),ea(!0)}})]})}),(0,a.jsx)(w.Z,{isOpen:J,onClose:()=>Q(!1),context:"lacqr_lens"}),(0,a.jsx)(E.Z,{isOpen:es,mode:el,onClose:()=>ea(!1),onClientSelected:ep}),(0,a.jsx)(A.Z,{isOpen:er,onClose:()=>ei(!1),context:"lacqr_lens",aiResult:R}),U&&Z&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:()=>G(!1),children:[(0,a.jsx)("button",{onClick:()=>G(!1),className:"absolute top-4 right-4 text-white hover:text-gray-300",children:(0,a.jsx)(r.Z,{size:32})}),(0,a.jsx)("img",{src:Z,alt:"Full size",className:"max-w-full max-h-full object-contain rounded-lg",onClick:e=>e.stopPropagation()})]})]})}function F(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("div",{className:"p-8 text-center",children:"Loading Lens..."}),children:(0,a.jsx)(R,{})})}},77907:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var a=s(57437),l=s(2265),n=s(69842),r=s(89506),i=s(43257),o=s(74697),c=s(3274);function d(e){let{isOpen:t,onClose:s,mode:d,onClientSelected:x}=e,{user:m}=(0,i.q)(),[u,g]=(0,l.useState)([]),[h,b]=(0,l.useState)(!1),[p,f]=(0,l.useState)(""),[j,y]=(0,l.useState)(""),[N,v]=(0,l.useState)(""),[w,k]=(0,l.useState)(""),[S,C]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t&&"assign"===d&&m.id&&(async()=>{b(!0);try{let e=(0,n.IO)((0,n.collection)(r.db,"users",m.id,"clients"),(0,n.Xo)("createdAt","desc")),t=(await (0,n.PL)(e)).docs.map(e=>({id:e.id,...e.data()}));g(t)}catch(e){console.error("Error fetching clients:",e)}finally{b(!1)}})()},[t,d,m.id]);let z=async e=>{if(e.preventDefault(),m.id){C(!0);try{let e={name:j,phone:N,email:w,notes:"",createdAt:new Date},t=await (0,n.addDoc)((0,n.collection)(r.db,"users",m.id,"clients"),e);x&&x({id:t.id,...e}),y(""),v(""),k(""),s()}catch(e){console.error("Error adding client:",e),alert("Failed to add client.")}finally{C(!1)}}},_=u.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.phone&&e.phone.includes(p));return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 space-y-6 animate-in fade-in zoom-in-95 duration-200 shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-charcoal",children:"assign"===d?"Select Client":"Add New Client"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-charcoal transition-colors",children:(0,a.jsx)(o.Z,{size:24})})]}),"assign"===d?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search clients...",value:p,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50",autoFocus:!0}),h?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(c.Z,{className:"animate-spin text-pink-500"})}):(0,a.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:0===_.length?(0,a.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No clients found."}):_.map(e=>(0,a.jsxs)("button",{onClick:()=>x&&x(e),className:"w-full text-left p-3 rounded-xl hover:bg-pink-50 transition-colors border border-gray-100 flex justify-between items-center group",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.phone||e.email})]}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-pink-500 opacity-0 group-hover:opacity-100 transition-opacity"})]},e.id))}),(0,a.jsx)("div",{className:"pt-2 border-t border-gray-100",children:(0,a.jsx)("button",{onClick:()=>{alert("To create a new client, close this modal and click 'New Client' in the menu.")},className:"w-full py-3 text-pink-600 font-bold hover:bg-pink-50 rounded-xl transition-colors",children:"+ Create New Client"})})]}):(0,a.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",required:!0,value:j,onChange:e=>y(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50 focus:bg-white transition-colors",placeholder:"e.g. Sarah Johnson",autoFocus:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:N,onChange:e=>v(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50 focus:bg-white transition-colors",placeholder:"(555) 123-4567"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",value:w,onChange:e=>k(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50 focus:bg-white transition-colors",placeholder:"sarah@example.com"})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)("button",{type:"submit",disabled:S,className:"w-full bg-charcoal text-white py-3 rounded-xl font-bold hover:bg-black transition-colors flex items-center justify-center disabled:opacity-70",children:S?(0,a.jsx)(c.Z,{className:"animate-spin"}):"Create Client"})})]})]})}):null}}},function(e){e.O(0,[4358,9637,2505,7337,9279,6704,9144,5623,742,4235,8502,1943,2971,7023,1744],function(){return e(e.s=29601)}),_N_E=e.O()}]);