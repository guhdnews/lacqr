(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6496,9506],{69753:function(e,t,s){Promise.resolve().then(s.bind(s,75809))},95137:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},71976:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},80233:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},40933:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},51077:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},3274:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4086:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},47390:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},89832:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},92513:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},59061:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},33907:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},10883:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},53225:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},36127:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},74697:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(78030).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},16463:function(e,t,s){"use strict";var a=s(71169);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},75809:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return H}});var a=s(57437),l=s(2265),n=s(16463),r=s(43257),i=s(69842),o=s(89506),d=s(95137),c=s(36127),u=s(10883),h=s(74697),x=s(59061),m=s(89832),p=s(4086),g=s(47390),b=s(78030);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,b.Z)("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),v=(0,b.Z)("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);var y=s(53225),j=s(92513),N=s(33907),k=s(71976),w=s(40933);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let S=(0,b.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),C=e=>{let t;if(0===e.length)return{stats:{},lifecycle:{}};let s=e.reduce((e,t)=>e+t.price,0),a=e.length,l=s/a,n="New";if(a>10&&l>50?n="A+":a>5&&l>40?n="A":a>2&&(n="B"),e.length>=2){let s=[...e].sort((e,t)=>t.date.seconds-e.date.seconds),l=1e3*s[0].date.seconds,n=new Date(l+(l-1e3*s[s.length-1].date.seconds)/864e5/(a-1)*864e5);t=i.EK.fromDate(n)}return{stats:{totalSpend:s,visitCount:a,averageTicket:l,clientGrade:n,lastVisitDate:e[0].date},lifecycle:{predictedNextVisit:t}}};var P=s(99854),L=s(53371);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let Z=(0,b.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var A=s(80233),M=s(51077),z=s(3274);function D(e){let{isOpen:t,onClose:n,clientId:d,onSuccess:c,initialData:u,serviceId:x}=e,{user:m}=(0,r.q)(),{menu:p}=(0,L.H)(),[g,b]=(0,l.useState)("Gel Manicure"),[f,v]=(0,l.useState)("Square"),[y,N]=(0,l.useState)("Short"),[k,w]=(0,l.useState)("Glossy"),[S,C]=(0,l.useState)("None"),[D,H]=(0,l.useState)("None"),[G,F]=(0,l.useState)("None"),[q,E]=(0,l.useState)("None"),[T,U]=(0,l.useState)("None"),[B,R]=(0,l.useState)(""),[X,I]=(0,l.useState)(""),[V,O]=(0,l.useState)(""),[_,K]=(0,l.useState)([]),[$,J]=(0,l.useState)({brand:"",code:"",name:"",category:"Color"}),[W,Q]=(0,l.useState)([]),[Y,ee]=(0,l.useState)([]),[et,es]=(0,l.useState)(!1),ea=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(u){var e,t,s;b(u.serviceType||"Gel Manicure"),v(u.shape||"Square"),N(u.length||"Short"),R((null===(e=u.price)||void 0===e?void 0:e.toString())||""),I((null===(t=u.tip)||void 0===t?void 0:t.toString())||""),O(u.techNotes||""),K(u.productsUsed||[]),(null===(s=u.photos)||void 0===s?void 0:s.after)&&ee(u.photos.after)}},[u]),(0,l.useEffect)(()=>{if(!p||u)return;let e=p.basePrices[g]||0,t=p.lengthSurcharges[y]||0,s=p.finishSurcharges[k]||0,a=p.specialtySurcharges[S]||0,l=p.classicDesignSurcharges[D]||0,n="None"!==G&&p.artLevelPrices[G]||0;R((e+t+s+a+l+n+(p.blingDensityPrices[q]||0)+(p.modifierSurcharges[T]||0)).toFixed(2))},[g,y,k,S,D,G,q,T,p,u]);let el=e=>{K(_.filter((t,s)=>s!==e))},en=async e=>{if(e.preventDefault(),m.id&&d){es(!0);try{var t;let e=[];for(let t of W){let s=(0,P.iH)(o.storage,"users/".concat(m.id,"/clients/").concat(d,"/").concat(Date.now(),"_").concat(t.name));await (0,P.KV)(s,t);let a=(0,P.Jt)(s);e.push(await a)}let a=u?[...(null===(t=u.photos)||void 0===t?void 0:t.after)||[],...e]:e,l={clientId:d,userId:m.id,date:u?u.date:i.EK.now(),serviceType:g,shape:f,length:y,productsUsed:_,addons:["Glossy"!==k?k:null,"None"!==S?S:null,"None"!==D?D:null,"None"!==G?G:null,"None"!==q?"Bling: ".concat(q):null,"None"!==T?T:null].filter(Boolean),price:parseFloat(B)||0,tip:parseFloat(X)||0,photos:{after:a},techNotes:V,updatedAt:i.EK.now()};if(x){let{doc:e,updateDoc:t}=await Promise.resolve().then(s.bind(s,69842));await t(e(o.db,"service_records",x),l)}else await (0,i.addDoc)((0,i.collection)(o.db,"service_records"),{...l,createdAt:i.EK.now()});c&&c(),n(),x||b("Gel Manicure")}catch(e){console.error("Error logging service:",e),alert("Failed to save service record.")}finally{es(!1)}}};return((0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n]),t)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",onClick:n,children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-2xl flex flex-col shadow-2xl max-h-[90vh] relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-100 bg-white z-10",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-charcoal",children:x?"Edit Visit":"Log New Visit"}),(0,a.jsx)("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(h.Z,{size:20,className:"text-gray-500"})})]}),(0,a.jsx)("div",{className:"overflow-y-auto p-6",children:(0,a.jsxs)("form",{onSubmit:en,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Service"}),(0,a.jsxs)("select",{value:g,onChange:e=>b(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 bg-gray-50 font-medium",children:[(0,a.jsx)("option",{children:"Gel Manicure"}),(0,a.jsx)("option",{children:"Acrylic"}),(0,a.jsx)("option",{children:"Gel-X"}),(0,a.jsx)("option",{children:"Hard Gel"}),(0,a.jsx)("option",{children:"Structure Gel"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Shape"}),(0,a.jsxs)("select",{value:f,onChange:e=>v(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 bg-gray-50 font-medium",children:[(0,a.jsx)("option",{children:"Square"}),(0,a.jsx)("option",{children:"Coffin"}),(0,a.jsx)("option",{children:"Almond"}),(0,a.jsx)("option",{children:"Stiletto"}),(0,a.jsx)("option",{children:"Oval"}),(0,a.jsx)("option",{children:"Squoval"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Length"}),(0,a.jsxs)("select",{value:y,onChange:e=>N(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 bg-gray-50 font-medium",children:[(0,a.jsx)("option",{children:"Short"}),(0,a.jsx)("option",{children:"Medium"}),(0,a.jsx)("option",{children:"Long"}),(0,a.jsx)("option",{children:"XL"}),(0,a.jsx)("option",{children:"XXL"})]})]})]}),(0,a.jsxs)("div",{className:"bg-pink-50 p-4 rounded-xl border border-pink-100",children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-pink-600 mb-3 flex items-center",children:[(0,a.jsx)(Z,{size:16,className:"mr-2"}),"Smart Pricing Add-ons"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Finish"}),(0,a.jsxs)("select",{value:k,onChange:e=>w(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("option",{children:"Glossy"}),(0,a.jsx)("option",{children:"Matte"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Specialty"}),(0,a.jsxs)("select",{value:S,onChange:e=>C(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("option",{children:"None"}),(0,a.jsx)("option",{children:"Chrome"}),(0,a.jsx)("option",{children:"Holo"}),(0,a.jsx)("option",{children:"Cat Eye"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Design"}),(0,a.jsxs)("select",{value:D,onChange:e=>H(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("option",{children:"None"}),(0,a.jsx)("option",{children:"French Tip"}),(0,a.jsx)("option",{children:"Ombre"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Art Level"}),(0,a.jsxs)("select",{value:G,onChange:e=>F(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("option",{children:"None"}),(0,a.jsx)("option",{children:"Level 1"}),(0,a.jsx)("option",{children:"Level 2"}),(0,a.jsx)("option",{children:"Level 3"}),(0,a.jsx)("option",{children:"Level 4"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Bling"}),(0,a.jsxs)("select",{value:q,onChange:e=>E(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("option",{children:"None"}),(0,a.jsx)("option",{children:"Minimal"}),(0,a.jsx)("option",{children:"Moderate"}),(0,a.jsx)("option",{children:"Heavy"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Foreign Work"}),(0,a.jsxs)("select",{value:T,onChange:e=>U(e.target.value),className:"w-full p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("option",{children:"None"}),(0,a.jsx)("option",{children:"Foreign Fill"}),(0,a.jsx)("option",{children:"Foreign Removal"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-100",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-700 mb-3",children:'Products Used (The "Recipe")'}),(0,a.jsxs)("div",{className:"space-y-2 mb-3",children:[_.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-white p-2 rounded-lg border border-gray-200 text-sm",children:[(0,a.jsx)("span",{className:"font-bold text-gray-600 w-16",children:e.category}),(0,a.jsxs)("span",{className:"font-medium text-charcoal flex-1 mx-2",children:[e.brand," ",e.code]}),(0,a.jsx)("span",{className:"text-gray-400 text-xs mr-2",children:e.name}),(0,a.jsx)("button",{type:"button",onClick:()=>el(t),className:"text-red-400 hover:text-red-600",children:(0,a.jsx)(h.Z,{size:16})})]},t)),0===_.length&&(0,a.jsx)("p",{className:"text-xs text-gray-400 italic text-center py-2",children:"No products logged yet."})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,a.jsx)("div",{className:"w-24",children:(0,a.jsx)("input",{placeholder:"Brand",className:"w-full p-2 rounded-lg border border-gray-200 text-sm",value:$.brand,onChange:e=>J({...$,brand:e.target.value})})}),(0,a.jsx)("div",{className:"w-20",children:(0,a.jsx)("input",{placeholder:"Code",className:"w-full p-2 rounded-lg border border-gray-200 text-sm",value:$.code,onChange:e=>J({...$,code:e.target.value})})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{placeholder:"Name (Optional)",className:"w-full p-2 rounded-lg border border-gray-200 text-sm",value:$.name,onChange:e=>J({...$,name:e.target.value})})}),(0,a.jsx)("button",{type:"button",onClick:()=>{$.brand&&$.code&&(K([..._,{...$}]),J({brand:"",code:"",name:"",category:"Color"}))},className:"bg-charcoal text-white p-2 rounded-lg hover:bg-black transition-colors",children:(0,a.jsx)(j.Z,{size:20})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Result Photos"}),(0,a.jsxs)("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=ea.current)||void 0===e?void 0:e.click()},className:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-pink-500 hover:text-pink-500 hover:bg-pink-50 transition-all flex-shrink-0",children:[(0,a.jsx)(A.Z,{size:24}),(0,a.jsx)("span",{className:"text-xs font-bold mt-1",children:"Add Photo"})]}),(0,a.jsx)("input",{type:"file",ref:ea,className:"hidden",multiple:!0,accept:"image/*",onChange:e=>{if(e.target.files){let t=Array.from(e.target.files);Q([...W,...t]),ee([...Y,...t.map(e=>URL.createObjectURL(e))])}}}),Y.map((e,t)=>(0,a.jsxs)("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden border border-gray-200 flex-shrink-0 group",children:[(0,a.jsx)("img",{src:e,alt:"Preview",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{type:"button",onClick:()=>{Q(W.filter((e,s)=>s!==t)),ee(Y.filter((e,s)=>s!==t))},className:"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(h.Z,{size:12})})]},t))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Total Price"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(M.Z,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),(0,a.jsx)("input",{type:"number",value:B,onChange:e=>R(e.target.value),className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 font-bold text-lg",placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tip Amount"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(M.Z,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),(0,a.jsx)("input",{type:"number",value:X,onChange:e=>I(e.target.value),className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 font-bold text-lg text-green-600",placeholder:"0.00"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tech Notes"}),(0,a.jsx)("textarea",{value:V,onChange:e=>O(e.target.value),className:"w-full p-3 rounded-xl border border-gray-200 text-sm h-24",placeholder:"Any issues? Client mood? Special requests?"})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)("button",{type:"submit",disabled:et,className:"w-full bg-pink-500 text-white py-4 rounded-xl font-bold hover:bg-pink-600 transition-colors flex items-center justify-center disabled:opacity-70 shadow-lg shadow-pink-200",children:et?(0,a.jsx)(z.Z,{className:"animate-spin mr-2"}):"Save Service Record"})})]})})]})}):null}function H(){var e,t,s,b,P,L,Z,A,M,z,H,G;let F=(0,n.useParams)(),q=(0,n.useRouter)(),E=F.id,{user:T}=(0,r.q)(),{client:U,history:B,pendingQuotes:R,notesHistory:X,loading:I,error:V,refresh:O}=function(e,t){let[s,a]=(0,l.useState)({client:null,lastServiceSnapshot:null,history:[],pendingQuotes:[],notesHistory:[],loading:!0,error:null}),n=(0,l.useCallback)(async()=>{if(e&&t)try{let s=(0,i.doc)(o.db,"users",e,"clients",t),l=await (0,i.getDoc)(s);if(!l.exists()){a(e=>({...e,loading:!1,error:"Client not found"}));return}let n={id:l.id,...l.data()},r=(0,i.collection)(o.db,"service_records"),d=(0,i.IO)(r,(0,i.ar)("clientId","==",t),(0,i.Xo)("date","desc")),c=(await (0,i.PL)(d)).docs.map(e=>({id:e.id,...e.data()})),u=[];try{let e=(0,i.collection)(o.db,"quotes"),s=(0,i.IO)(e,(0,i.ar)("clientId","==",t),(0,i.ar)("status","==","pending"),(0,i.Xo)("createdAt","desc"));u=(await (0,i.PL)(s)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.warn("Failed to fetch quotes (likely missing index), continuing without them:",e)}let h=[];try{let s=(0,i.collection)(o.db,"users",e,"clients",t,"notes"),a=(0,i.IO)(s,(0,i.Xo)("createdAt","desc"));h=(await (0,i.PL)(a)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.warn("Failed to fetch notes:",e)}let{stats:x,lifecycle:m}=C(c),p={...n,stats:{...n.stats,...x},lifecycle:{...n.lifecycle,...m}};a({client:p,lastServiceSnapshot:c.length>0?c[0]:null,history:c,pendingQuotes:u,notesHistory:h,loading:!1,error:null})}catch(e){console.error("Error fetching smart profile:",e),a(t=>({...t,loading:!1,error:e.message}))}},[e,t]);return(0,l.useEffect)(()=>{n()},[n]),{...s,refresh:n}}((null==T?void 0:T.id)||void 0,E),[_,K]=(0,l.useState)(!1),[$,J]=(0,l.useState)({}),[W,Q]=(0,l.useState)(!1),[Y,ee]=(0,l.useState)(null),[et,es]=(0,l.useState)(""),[ea,el]=(0,l.useState)(!1),en=async()=>{if(et.trim()&&(null==T?void 0:T.id))try{await (0,i.addDoc)((0,i.collection)(o.db,"users",T.id,"clients",E,"notes"),{content:et,createdAt:new Date,createdBy:"Staff"}),es(""),el(!1),O()}catch(e){console.error("Error adding note:",e),alert("Failed to add note.")}},er=async e=>{if(confirm("Delete this note?")&&(null==T?void 0:T.id))try{await (0,i.oe)((0,i.doc)(o.db,"users",T.id,"clients",E,"notes",e)),O()}catch(e){console.error("Error deleting note:",e),alert("Failed to delete note.")}};(0,l.useEffect)(()=>{if(U){var e,t,s,a;J({name:U.name,phone:U.phone,email:U.email,instagram:U.instagram,bedSize:null===(e=U.nailProfile)||void 0===e?void 0:e.bedSize,cuticleType:null===(t=U.nailProfile)||void 0===t?void 0:t.cuticleType,naturalNailHealth:null===(s=U.nailProfile)||void 0===s?void 0:s.naturalNailHealth,nailNotes:null===(a=U.nailProfile)||void 0===a?void 0:a.notes,notes:U.notes||""})}},[U]);let ei=async()=>{try{await (0,i.updateDoc)((0,i.doc)(o.db,"clients",E),{name:$.name,phone:$.phone,email:$.email,instagram:$.instagram,notes:$.notes,nailProfile:{bedSize:$.bedSize,cuticleType:$.cuticleType,naturalNailHealth:$.naturalNailHealth,notes:$.nailNotes}}),K(!1),O()}catch(e){console.error("Error updating profile:",e),alert("Failed to update profile.")}},eo=async()=>{if(confirm("Are you sure you want to delete this client? This will move them to the trash for 7 days."))try{await (0,i.updateDoc)((0,i.doc)(o.db,"clients",E),{status:"deleted",deletedAt:new Date}),q.push("/dashboard/crm")}catch(e){console.error("Error deleting client:",e),alert("Failed to delete client.")}},ed=async e=>{if(confirm("Are you sure you want to delete this service record?"))try{await (0,i.oe)((0,i.doc)(o.db,"service_records",e)),O()}catch(e){console.error("Error deleting service:",e),alert("Failed to delete service record.")}};return I?(0,a.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading client profile..."}):V||!U?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Client not found"}),(0,a.jsx)("p",{className:"text-red-500",children:V}),(0,a.jsx)("button",{onClick:()=>q.back(),className:"text-pink-500 hover:underline mt-4",children:"Go Back"})]}):(0,a.jsxs)("div",{className:"max-w-5xl mx-auto p-4 space-y-8 pb-20",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>q.back(),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(d.Z,{size:20,className:"text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[_?(0,a.jsx)("input",{value:$.name||"",onChange:e=>J({...$,name:e.target.value}),className:"text-3xl font-bold font-serif text-charcoal border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent"}):(0,a.jsx)("h1",{className:"text-3xl font-bold font-serif text-charcoal",children:U.name}),(null===(e=U.stats)||void 0===e?void 0:e.clientGrade)&&(0,a.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(U.stats.clientGrade.startsWith("A")?"bg-green-100 text-green-700":"B"===U.stats.clientGrade?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:["Grade: ",U.stats.clientGrade]})]}),(0,a.jsxs)("p",{className:"text-gray-500 text-sm flex items-center gap-2",children:["Client since ",U.createdAt?new Date(1e3*U.createdAt.seconds).toLocaleDateString():"Unknown",(null===(t=U.lifecycle)||void 0===t?void 0:t.churnRisk)&&(0,a.jsxs)("span",{className:"flex items-center text-red-500 font-bold text-xs",children:[(0,a.jsx)(c.Z,{size:12,className:"mr-1"})," At Risk"]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm text-center min-w-[100px]",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"LTV"}),(0,a.jsxs)("p",{className:"font-bold text-lg text-green-600",children:["$",((null===(s=U.stats)||void 0===s?void 0:s.totalSpend)||0).toFixed(0)]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm text-center min-w-[100px]",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Avg Ticket"}),(0,a.jsxs)("p",{className:"font-bold text-lg text-charcoal",children:["$",((null===(b=U.stats)||void 0===b?void 0:b.averageTicket)||0).toFixed(0)]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm text-center min-w-[100px]",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Next Due"}),(0,a.jsx)("p",{className:"font-bold text-lg text-blue-600",children:(null===(P=U.lifecycle)||void 0===P?void 0:P.predictedNextVisit)?new Date(1e3*U.lifecycle.predictedNextVisit.seconds).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"TBD"})]})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm space-y-4 relative",children:[(0,a.jsx)("div",{className:"absolute top-4 right-4 flex space-x-2",children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>eo(),className:"p-1 hover:bg-red-100 rounded text-red-500",title:"Delete Client",children:(0,a.jsx)(u.Z,{size:16})}),(0,a.jsx)("button",{onClick:()=>K(!1),className:"p-1 hover:bg-gray-100 rounded text-gray-500",children:(0,a.jsx)(h.Z,{size:16})}),(0,a.jsx)("button",{onClick:ei,className:"p-1 hover:bg-green-100 rounded text-green-600",children:(0,a.jsx)(x.Z,{size:16})})]}):(0,a.jsx)("button",{onClick:()=>K(!0),className:"text-xs text-pink-500 font-bold hover:underline",children:"Edit Profile"})}),(0,a.jsx)("h3",{className:"font-bold text-gray-800 mb-2",children:"Contact Details"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-gray-600",children:[(0,a.jsx)(m.Z,{size:18,className:"text-pink-500"}),_?(0,a.jsx)("input",{value:$.phone||"",onChange:e=>J({...$,phone:e.target.value}),className:"font-medium border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent w-full",placeholder:"Phone"}):(0,a.jsx)("p",{className:"font-medium",children:U.phone||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-gray-600",children:[(0,a.jsx)(p.Z,{size:18,className:"text-purple-500"}),_?(0,a.jsx)("input",{value:$.email||"",onChange:e=>J({...$,email:e.target.value}),className:"font-medium border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent w-full",placeholder:"Email"}):(0,a.jsx)("p",{className:"font-medium",children:U.email||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-gray-600",children:[(0,a.jsx)(g.Z,{size:18,className:"text-blue-500"}),_?(0,a.jsx)("input",{value:$.instagram||"",onChange:e=>J({...$,instagram:e.target.value}),className:"font-medium border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent w-full",placeholder:"Instagram"}):(0,a.jsx)("p",{className:"font-medium",children:U.instagram||"N/A"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:"Nail Profile"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500 flex items-center",children:[(0,a.jsx)(f,{size:14,className:"mr-2"})," Bed Size"]}),_?(0,a.jsxs)("select",{value:$.bedSize||"Unknown",onChange:e=>J({...$,bedSize:e.target.value}),className:"text-right border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent",children:[(0,a.jsx)("option",{children:"Small"}),(0,a.jsx)("option",{children:"Medium"}),(0,a.jsx)("option",{children:"Large"}),(0,a.jsx)("option",{children:"Unknown"})]}):(0,a.jsx)("span",{className:"font-medium",children:(null===(L=U.nailProfile)||void 0===L?void 0:L.bedSize)||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500 flex items-center",children:[(0,a.jsx)(v,{size:14,className:"mr-2"})," Cuticle"]}),_?(0,a.jsxs)("select",{value:$.cuticleType||"Unknown",onChange:e=>J({...$,cuticleType:e.target.value}),className:"text-right border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent",children:[(0,a.jsx)("option",{children:"Dry"}),(0,a.jsx)("option",{children:"Oily"}),(0,a.jsx)("option",{children:"Normal"}),(0,a.jsx)("option",{children:"Unknown"})]}):(0,a.jsx)("span",{className:"font-medium",children:(null===(Z=U.nailProfile)||void 0===Z?void 0:Z.cuticleType)||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-500 flex items-center",children:[(0,a.jsx)(y.Z,{size:14,className:"mr-2"})," Health"]}),_?(0,a.jsxs)("select",{value:$.naturalNailHealth||"Unknown",onChange:e=>J({...$,naturalNailHealth:e.target.value}),className:"text-right border-b border-gray-300 focus:border-pink-500 outline-none bg-transparent",children:[(0,a.jsx)("option",{children:"Strong"}),(0,a.jsx)("option",{children:"Brittle"}),(0,a.jsx)("option",{children:"Peeling"}),(0,a.jsx)("option",{children:"Bitten"}),(0,a.jsx)("option",{children:"Unknown"})]}):(0,a.jsx)("span",{className:"font-medium ".concat((null===(A=U.nailProfile)||void 0===A?void 0:A.naturalNailHealth)==="Strong"?"text-green-600":(null===(M=U.nailProfile)||void 0===M?void 0:M.naturalNailHealth)==="Brittle"?"text-amber-600":"text-gray-800"),children:(null===(z=U.nailProfile)||void 0===z?void 0:z.naturalNailHealth)||"Unknown"})]})]}),(_||(null===(H=U.nailProfile)||void 0===H?void 0:H.notes))&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-50 text-sm text-gray-600 italic",children:_?(0,a.jsx)("textarea",{value:$.nailNotes||"",onChange:e=>J({...$,nailNotes:e.target.value}),className:"w-full p-2 border rounded-lg text-sm",placeholder:"Notes..."}):(0,a.jsxs)(a.Fragment,{children:['"',null===(G=U.nailProfile)||void 0===G?void 0:G.notes,'"']})})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"font-bold text-xl text-charcoal",children:"Service History"}),(0,a.jsxs)("button",{onClick:()=>{ee(null),Q(!0)},className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(j.Z,{size:16})," Log Visit"]})]}),R&&R.length>0&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 p-6 rounded-3xl border border-pink-100",children:[(0,a.jsxs)("h4",{className:"font-bold text-pink-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(N.Z,{size:18})," Pending Quotes"]}),(0,a.jsx)("div",{className:"space-y-3",children:R.map(e=>{var t,s,l,n;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl border border-pink-100 shadow-sm flex justify-between items-center group hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-bold text-gray-800",children:[(null===(s=e.data)||void 0===s?void 0:null===(t=s.base)||void 0===t?void 0:t.system)||"Custom Set"," - ",(null===(n=e.data)||void 0===n?void 0:null===(l=n.base)||void 0===l?void 0:l.length)||"Medium"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[(0,a.jsxs)("span",{className:"font-medium text-pink-600",children:["$",e.totalPrice]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:new Date(1e3*e.createdAt.seconds).toLocaleDateString()})]})]}),(0,a.jsxs)("button",{onClick:()=>{var t,s,a,l,n,r,i,o,d,c;ee({...e,price:e.totalPrice,serviceType:"".concat(null===(s=e.data)||void 0===s?void 0:null===(t=s.base)||void 0===t?void 0:t.system," ").concat(null===(l=e.data)||void 0===l?void 0:null===(a=l.base)||void 0===a?void 0:a.shape," Set"),notes:"Based on Lacqr Lens Scan:\n- Length: ".concat(null===(r=e.data)||void 0===r?void 0:null===(n=r.base)||void 0===n?void 0:n.length,"\n- Art Level: ").concat(null===(o=e.data)||void 0===o?void 0:null===(i=o.art)||void 0===i?void 0:i.level,"\n- Addons: ").concat(null===(c=e.data)||void 0===c?void 0:null===(d=c.addons)||void 0===d?void 0:d.specialtyEffect)}),Q(!0)},className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-600 transition-colors flex items-center gap-2",children:["Book ",(0,a.jsx)(k.Z,{size:14})]})]},e.id)})})]}),0===B.length?(0,a.jsx)("div",{className:"text-center py-12 bg-gray-50 rounded-3xl border border-dashed border-gray-200",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No history found. Log their first visit!"})}):(0,a.jsx)("div",{className:"space-y-3",children:B.map(e=>(0,a.jsx)("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"w-16 h-16 bg-pink-50 rounded-xl flex flex-col items-center justify-center text-pink-500 font-bold leading-none shadow-sm",children:[(0,a.jsx)("span",{className:"text-[10px] uppercase tracking-wide",children:e.date?new Date(1e3*e.date.seconds).toLocaleDateString("en-US",{month:"short"}):""}),(0,a.jsx)("span",{className:"text-2xl my-0.5",children:e.date?new Date(1e3*e.date.seconds).getDate():"?"}),(0,a.jsx)("span",{className:"text-[10px] text-pink-400",children:e.date?new Date(1e3*e.date.seconds).getFullYear():""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-charcoal text-lg",children:e.serviceType}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(w.Z,{size:12}),e.date?new Date(1e3*e.date.seconds).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):""]}),e.addons&&e.addons.length>0&&(0,a.jsxs)("span",{children:["• + ",e.addons.join(", ")]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-bold text-lg",children:["$",e.price]}),e.tip>0&&(0,a.jsxs)("p",{className:"text-xs text-green-600 font-medium",children:["+$",e.tip," tip"]}),(0,a.jsxs)("div",{className:"flex space-x-2 justify-end mt-2",children:[(0,a.jsx)("button",{onClick:()=>{ee(e),Q(!0)},className:"text-gray-300 hover:text-blue-500 transition-colors",title:"Edit Record",children:(0,a.jsx)(S,{size:16})}),(0,a.jsx)("button",{onClick:()=>ed(e.id),className:"text-gray-300 hover:text-red-500 transition-colors",title:"Delete Record",children:(0,a.jsx)(u.Z,{size:16})})]})]})]})},e.id))}),(0,a.jsxs)("div",{className:"space-y-4 pt-8 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"font-bold text-xl text-charcoal flex items-center gap-2",children:[(0,a.jsx)(g.Z,{size:20,className:"text-yellow-500"}),"Client Notes History"]}),(0,a.jsx)("button",{onClick:()=>el(!ea),className:"text-pink-500 font-bold text-sm hover:underline",children:ea?"Cancel":"+ Add Note"})]}),ea&&(0,a.jsxs)("div",{className:"bg-white p-4 rounded-2xl border border-pink-100 shadow-sm animate-in fade-in slide-in-from-top-2",children:[(0,a.jsx)("textarea",{value:et,onChange:e=>es(e.target.value),className:"w-full p-3 border border-gray-200 rounded-xl text-sm focus:border-pink-500 outline-none min-h-[100px]",placeholder:"Write a note about this client...",autoFocus:!0}),(0,a.jsx)("div",{className:"flex justify-end mt-2",children:(0,a.jsx)("button",{onClick:en,disabled:!et.trim(),className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold text-sm hover:bg-pink-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Note"})})]}),(0,a.jsx)("div",{className:"space-y-3",children:X&&X.length>0?X.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow group",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap flex-1",children:e.content}),(0,a.jsx)("button",{onClick:()=>er(e.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity ml-2",title:"Delete Note",children:(0,a.jsx)(u.Z,{size:14})})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-400",children:[(0,a.jsx)("span",{children:e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString():"Unknown Date"}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e.createdBy||"Staff"})]})]},e.id)):(0,a.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"No notes yet. Add one to keep track of preferences!"})})})]})]})]}),(0,a.jsx)(D,{isOpen:W,onClose:()=>Q(!1),clientId:E,onSuccess:O,initialData:Y,serviceId:null==Y?void 0:Y.id})]})}},89506:function(e,t,s){"use strict";s.r(t),s.d(t,{app:function(){return i},auth:function(){return o},db:function(){return d},storage:function(){return c}});var a=s(15236),l=s(5186),n=s(69842),r=s(99854);let i=(0,a.ZF)({apiKey:"AIzaSyB... (rest of your firebase config)",authDomain:"lacqr-app-81378.firebaseapp.com",projectId:"lacqr-app-81378",storageBucket:"lacqr-app-81378.firebasestorage.app",messagingSenderId:"193977101196",appId:"1:193977101196:web:a2546131f7d99e17a2c4a9"}),o=(0,l.v0)(i),d=(0,n.ad)(i),c=(0,r.cF)(i)},43257:function(e,t,s){"use strict";s.d(t,{q:function(){return n}});var a=s(10903),l=s(89291);let n=(0,a.U)()((0,l.tJ)(e=>({theme:"light",toggleTheme:()=>e(e=>({theme:"light"===e.theme?"dark":"light"})),user:{id:null,name:null,email:null,salonName:null,bookingHandle:null,bookingConfig:null,isAuthenticated:!1,onboardingComplete:!1},isAuthReady:!1,setAuthReady:t=>e({isAuthReady:t}),setUser:t=>e({user:t}),logout:()=>e({user:{id:null,name:null,email:null,salonName:null,bookingHandle:null,logoUrl:null,headerImageUrl:null,brandColor:null,font:"sans",buttonStyle:"rounded",bookingConfig:null,isAuthenticated:!1,onboardingComplete:!1}}),notifications:[],addNotification:(t,s)=>e(e=>({notifications:[...e.notifications,{id:Date.now().toString(),message:t,type:s}]})),removeNotification:t=>e(e=>({notifications:e.notifications.filter(e=>e.id!==t)}))}),{name:"lacqr-storage",partialize:e=>({theme:e.theme,user:e.user}),version:1,migrate:(e,t)=>0===t?{theme:"light",user:{id:null,name:null,email:null,salonName:null,bookingHandle:null,logoUrl:null,headerImageUrl:null,brandColor:null,font:"sans",buttonStyle:"rounded",bookingConfig:null,isAuthenticated:!1,onboardingComplete:!1}}:e}))},53371:function(e,t,s){"use strict";s.d(t,{H:function(){return r}});var a=s(10903),l=s(89291),n=s(61551);let r=(0,a.U)()((0,l.tJ)(e=>({menu:n.p,updateBasePrice:(t,s)=>e(e=>({menu:{...e.menu,basePrices:{...e.menu.basePrices,[t]:s}}})),updateLengthSurcharge:(t,s)=>e(e=>({menu:{...e.menu,lengthSurcharges:{...e.menu.lengthSurcharges,[t]:s}}})),updateFinishSurcharge:(t,s)=>e(e=>({menu:{...e.menu,finishSurcharges:{...e.menu.finishSurcharges,[t]:s}}})),updateSpecialtySurcharge:(t,s)=>e(e=>({menu:{...e.menu,specialtySurcharges:{...e.menu.specialtySurcharges,[t]:s}}})),updateClassicDesignSurcharge:(t,s)=>e(e=>({menu:{...e.menu,classicDesignSurcharges:{...e.menu.classicDesignSurcharges,[t]:s}}})),updateArtLevelPrice:(t,s)=>e(e=>({menu:{...e.menu,artLevelPrices:{...e.menu.artLevelPrices,[t]:s}}})),updateBlingDensityPrice:(t,s)=>e(e=>({menu:{...e.menu,blingDensityPrices:{...e.menu.blingDensityPrices,[t]:s}}})),updateUnitPrice:(t,s)=>e(e=>({menu:{...e.menu,unitPrices:{...e.menu.unitPrices,[t]:s}}})),updateModifierSurcharge:(t,s)=>e(e=>({menu:{...e.menu,modifierSurcharges:{...e.menu.modifierSurcharges,[t]:s}}})),updatePedicurePrice:(t,s)=>e(e=>({menu:{...e.menu,pedicurePrices:{...e.menu.pedicurePrices,[t]:s}}})),resetMenu:()=>e({menu:n.p})}),{name:"lacqr-service-menu-v2"}))},61551:function(e,t,s){"use strict";s.d(t,{p:function(){return a}});let a={basePrices:{Acrylic:55,"Gel-X":65,"Hard Gel":60,"Structure Gel":50},fillPrices:{Acrylic:45,"Gel-X":55,"Hard Gel":50,"Structure Gel":40},lengthSurcharges:{Short:0,Medium:5,Long:10,XL:15,XXL:20},shapeSurcharges:{Square:0,Squoval:0,Coffin:0,Almond:5,Stiletto:5,Ballerina:5,Lipstick:5,Duck:10},finishSurcharges:{Glossy:0,Matte:5},specialtySurcharges:{None:0,Chrome:15,Holo:15,"Cat Eye":15},classicDesignSurcharges:{None:0,"French Tip":15,Ombre:15},artLevelPrices:{"Level 1":10,"Level 2":25,"Level 3":45,"Level 4":70},blingDensityPrices:{None:0,Minimal:10,Moderate:25,Heavy:50},unitPrices:{xlCharms:5,piercings:5,repairs:5,soakOff:20},modifierSurcharges:{None:0,"Foreign Fill":15,"Foreign Removal":25},pedicurePrices:{None:0,Classic:35,Gel:50,"Acrylic Toe Set":65},durations:{base:{Acrylic:60,"Gel-X":45,"Hard Gel":60,"Structure Gel":45},fill:{Acrylic:45,"Gel-X":45,"Hard Gel":45,"Structure Gel":30},length:{Short:0,Medium:15,Long:30,XL:60,XXL:90},shape:{Square:0,Squoval:0,Coffin:0,Almond:0,Stiletto:0,Ballerina:0,Lipstick:0,Duck:30},art:{"Level 1":15,"Level 2":30,"Level 3":60,"Level 4":120},bling:{None:0,Minimal:15,Moderate:30,Heavy:60},pedicure:{None:0,Classic:30,Gel:45,"Acrylic Toe Set":60},removal:30}}}},function(e){e.O(0,[4358,9637,9279,6704,9144,5623,742,2971,7023,1744],function(){return e(e.s=69753)}),_N_E=e.O()}]);