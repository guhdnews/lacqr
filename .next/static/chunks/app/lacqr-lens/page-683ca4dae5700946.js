(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1620],{574:function(e,t,s){Promise.resolve().then(s.bind(s,20115))},20115:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return $}});var a=s(57437),l=s(2265),n=s(16463),r=s(99687),i=s(76780),o=s(74697),c=s(80233),d=s(44828),x=s(82616),m=s(36127),u=s(55636),g=s(3722),b=s(71976),h=s(95137),p=s(78233),f=s(39134),j=s(69842),y=s(89506),N=s(23700),v=s(22682),w=s(98714),k=s(53371),C=s(43257),S=s(60479),_=s(11925),q=s(22468),z=s(37164),Z=s(81173),D=s.n(Z),P=s(97501);function I(e){var t;let{initialSelection:s,onSaveDraft:n,onAssignClient:r,onCreateClient:i}=e,{menu:o}=(0,k.H)(),{user:c}=(0,C.q)(),[d]=(0,l.useState)(s),x=(0,_.e)(d,o),[m,u]=(0,l.useState)(!1),g={unitPrices:{artLevel1:5,artLevel2:10,artLevel3:15,artLevel4:20,charm:3,xlCharms:5,piercing:5,crystal:.5}},b=async()=>{let e=document.getElementById("receipt-print-view");if(e)try{let t=await D()(e,{scale:2,backgroundColor:"#ffffff",logging:!1}),s=t.toDataURL("image/png"),a=new P.ZP({orientation:"portrait",unit:"mm",format:"a4"}),l=210*t.height/t.width;a.addImage(s,"PNG",0,0,210,l),a.save("Lacqr-Receipt-".concat(new Date().toISOString().split("T")[0],".pdf"))}catch(e){console.error("PDF Generation failed:",e),alert("Failed to generate PDF. Please try again.")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gray-900 p-6 text-white flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Receipt Preview"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Review final details before saving"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-3xl font-black",children:["$",x.total]}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Estimated Total"})]})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-gray-900 block",children:d.base.system}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[d.base.length," / ",d.base.shape]})]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",x.breakdown.base+x.breakdown.length+x.breakdown.shape]})]}),d.art.level&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:["Art Level: ",d.art.level]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",x.breakdown.art]})]}),"None"!==d.bling.density&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:["Bling: ",d.bling.density]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",x.breakdown.bling]})]}),d.bling.xlCharmsCount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:["Charms (x",d.bling.xlCharmsCount,")"]}),(0,a.jsxs)("span",{className:"font-bold",children:["$",d.bling.xlCharmsCount*g.unitPrices.xlCharms]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[(0,a.jsxs)("button",{onClick:()=>u(!0),className:"bg-charcoal text-white py-3 rounded-xl font-bold hover:bg-black transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(q.Z,{size:18}),(0,a.jsx)("span",{children:"Save Quote"})]}),(0,a.jsxs)("button",{onClick:b,className:"border border-gray-200 text-gray-700 py-3 rounded-xl font-bold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(z.Z,{size:18}),(0,a.jsx)("span",{children:"Download PDF"})]})]})]}),m&&(0,a.jsx)("div",{className:"absolute inset-0 bg-white/90 backdrop-blur-sm flex items-center justify-center p-6 z-10 animate-in fade-in",children:(0,a.jsxs)("div",{className:"bg-white shadow-2xl rounded-2xl p-6 w-full max-w-sm border border-gray-100 space-y-3",children:[(0,a.jsx)("h3",{className:"font-bold text-center text-lg mb-4",children:"Save Quote To..."}),(0,a.jsx)("button",{onClick:r,className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-900 rounded-lg transition-colors font-medium",children:"Existing Client"}),(0,a.jsx)("button",{onClick:i,className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-900 rounded-lg transition-colors font-medium",children:"New Client"}),(0,a.jsx)("button",{onClick:()=>n(d),className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-900 rounded-lg transition-colors font-medium",children:"Save as Draft"}),(0,a.jsx)("button",{onClick:()=>u(!1),className:"w-full text-center text-sm text-gray-500 hover:text-gray-700 py-2 mt-2",children:"Cancel"})]})})]}),(0,a.jsxs)("div",{id:"receipt-print-view",className:"fixed -left-[9999px] top-0 w-[800px] bg-white p-12 text-gray-900 font-sans",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-5xl font-black text-gray-900 tracking-tighter mb-2 uppercase",children:(null==c?void 0:c.salonName)||"LACQR"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 uppercase tracking-widest",children:"Premium Nail Service"})]}),(0,a.jsxs)("div",{className:"border-t-2 border-b-2 border-gray-900 py-8 mb-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("span",{className:"font-bold text-xl text-gray-900",children:"Date"}),(0,a.jsx)("span",{className:"font-mono text-lg text-gray-600",children:new Date().toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-bold text-xl text-gray-900",children:"Time"}),(0,a.jsx)("span",{className:"font-mono text-lg text-gray-600",children:new Date().toLocaleTimeString()})]})]}),(0,a.jsxs)("div",{className:"space-y-6 mb-12",children:[(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-2xl text-gray-900 block",children:d.base.system}),(0,a.jsxs)("span",{className:"text-lg text-gray-500",children:[d.base.isFill?"Fill In":"Full Set"," - ",d.base.length," / ",d.base.shape]})]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-2xl",children:["$",x.breakdown.base+x.breakdown.length+x.breakdown.shape]})]}),d.art.level&&(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("span",{className:"font-medium text-xl text-gray-700",children:["Art Level: ",d.art.level]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",x.breakdown.art]})]}),"None"!==d.bling.density&&(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("span",{className:"font-medium text-xl text-gray-700",children:["Bling: ",d.bling.density]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",x.breakdown.bling]})]}),d.bling.xlCharmsCount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsxs)("span",{className:"font-medium text-xl text-gray-700",children:["Charms (x",d.bling.xlCharmsCount,")"]}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",d.bling.xlCharmsCount*g.unitPrices.xlCharms]})]}),null===(t=d.extras)||void 0===t?void 0:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,a.jsx)("span",{className:"font-medium text-xl text-gray-700",children:e.name}),(0,a.jsxs)("span",{className:"font-mono font-bold text-xl",children:["$",e.price]})]},t))]}),(0,a.jsxs)("div",{className:"border-t-4 border-gray-900 pt-8 flex justify-between items-end mb-16",children:[(0,a.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:"Total"}),(0,a.jsxs)("span",{className:"text-6xl font-black text-gray-900",children:["$",x.total]})]}),(0,a.jsxs)("div",{className:"text-center text-gray-400 space-y-2 mt-auto",children:[(0,a.jsxs)("p",{className:"text-lg font-medium text-gray-900",children:["Thank you for choosing ",(null==c?void 0:c.salonName)||"us","."]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-8 pt-8 border-t border-gray-100",children:[(0,a.jsx)("span",{className:"text-xs uppercase tracking-widest text-gray-400",children:"Powered by"}),(0,a.jsx)("span",{className:"font-black text-sm text-pink-600 uppercase tracking-widest",children:"LACQR"})]})]})]})]})}var A=s(77907),E=s(18866),L=s(85016),F=s(87592),R=s(87138);function O(){let{user:e}=(0,C.q)(),[t,s]=(0,l.useState)(0),[n,r]=(0,l.useState)([{id:"account",label:"Create Account",completed:!0,link:"#"},{id:"profile",label:"Complete User Profile",completed:e.onboardingComplete,link:"/settings"},{id:"menu",label:"Configure Service Menu",completed:e.onboardingComplete,link:"/service-menu"},{id:"payments",label:"Set up Payments",completed:e.onboardingComplete,link:"/settings"}]);return((0,l.useEffect)(()=>{let t=[...n];t[1].completed=e.onboardingComplete,t[2].completed=e.onboardingComplete,t[3].completed=e.onboardingComplete,s(Math.round(t.filter(e=>e.completed).length/t.length*100)),r(t)},[e.onboardingComplete]),100===t)?null:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-bold text-charcoal text-lg flex items-center",children:[(0,a.jsx)(L.Z,{className:"text-yellow-500 mr-2",size:20}),"Getting Started"]}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Complete these steps href unlock your Pro Badge."})]}),(0,a.jsxs)("span",{className:"font-bold text-pink-500",children:[t,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-100 rounded-full h-2 mb-6",children:(0,a.jsx)("div",{className:"bg-pink-500 h-2 rounded-full transition-all duration-1000 ease-out",style:{width:"".concat(t,"%")}})}),(0,a.jsx)("div",{className:"space-y-3",children:n.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center mr-3 ".concat(e.completed?"bg-green-100 text-green-600":"bg-gray-100 text-gray-300"),children:(0,a.jsx)(q.Z,{size:14})}),(0,a.jsx)("span",{className:"".concat(e.completed?"text-gray-400 line-through":"text-charcoal font-medium"),children:e.label})]}),!e.completed&&(0,a.jsxs)(R.default,{href:e.link,className:"text-sm text-pink-500 font-bold opacity-0 group-hover:opacity-100 transition-opacity flex items-center",children:["Go ",(0,a.jsx)(F.Z,{size:14})]})]},e.id))})]})}function T(){let{menu:e}=(0,k.H)(),t=(0,n.useSearchParams)(),q=(0,n.useRouter)(),[z,Z]=(0,l.useState)(()=>localStorage.getItem("lacqr_lens_image")),[D,P]=(0,l.useState)(!1),[L,F]=(0,l.useState)(()=>{{let e=localStorage.getItem("lacqr_lens_result");return e?JSON.parse(e):null}}),[R,T]=(0,l.useState)(!1),[$,G]=(0,l.useState)(1),[B,M]=(0,l.useState)(!1),[Q,U]=(0,l.useState)(!1),[J,H]=(0,l.useState)(()=>localStorage.getItem("lacqr_lens_step")||"scan");(0,l.useEffect)(()=>{z?localStorage.setItem("lacqr_lens_image",z):localStorage.removeItem("lacqr_lens_image")},[z]),(0,l.useEffect)(()=>{L?localStorage.setItem("lacqr_lens_result",JSON.stringify(L)):localStorage.removeItem("lacqr_lens_result")},[L]),(0,l.useEffect)(()=>{localStorage.setItem("lacqr_lens_step",J)},[J]),(0,l.useEffect)(()=>{let e=t.get("draftId");e&&(async()=>{try{let t=await (0,j.getDoc)((0,j.doc)(y.db,"quotes",e));if(t.exists()){let e=t.data();F(e.data),H("configure"),q.replace("/lacqr-lens")}}catch(e){console.error("Error fetching draft:",e)}})()},[t,q]);let[V,W]=(0,l.useState)(!1),[Y,K]=(0,l.useState)("create"),[X,ee]=(0,l.useState)(!1),{isCoolingDown:et,remainingTime:es,startCooldown:ea}=(0,v.q)({cooldownTime:1e4,key:"lacqr_lens_scan"}),[el,en]=(0,l.useState)(null),{user:er}=(0,C.q)(),ei=l.useRef(null),eo=async e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(ei.current&&(ei.current.value=""),et){alert("Please wait ".concat(es,"s before scanning again."));return}if(s){let e=new FileReader;e.onloadend=async()=>{let t=e.result;Z(t),T(await (0,f.Ok)(t))},e.readAsDataURL(s),P(!0),F(null),en(null),H("scan");try{let e=await (0,f.hv)(s),t=await p.Go.analyzeImage(e);F(t),H("configure"),ea()}catch(e){console.error("Analysis failed",e),en(e.message||"An unexpected error occurred.")}finally{P(!1)}}},ec=()=>{D||(Z(null),F(null),P(!1),T(!1),G(1),H("scan"),localStorage.removeItem("lacqr_lens_image"),localStorage.removeItem("lacqr_lens_result"),localStorage.removeItem("lacqr_lens_step"))},ed=async t=>{if(!er.isAuthenticated||!er.id){alert("Please log in to save drafts.");return}try{let{addDoc:a,collection:l}=await Promise.resolve().then(s.bind(s,69842)),{db:n}=await Promise.resolve().then(s.bind(s,89506)),r=new Date;r.setDate(r.getDate()+14),await a(l(n,"quotes"),{userId:er.id,status:"draft",data:t,createdAt:new Date,expiresAt:r,salonName:er.name||"My Salon",totalPrice:(0,_.e)(t,e)}),alert("Draft saved! It will be kept for 14 days.")}catch(e){console.error("Error saving draft:",e),alert("Failed to save draft. Please try again.")}},ex=async t=>{if(L&&er)try{let s=(0,_.e)(L,e);await (0,j.addDoc)((0,j.collection)(y.db,"quotes"),{type:"assigned",data:L,totalPrice:s,createdAt:new Date,salonName:er.name||"Your Salon",userId:er.id,clientId:t.id,clientName:t.name,status:"pending"}),alert("Quote saved for ".concat(t.name,"!")),ec()}catch(e){console.error("Error saving quote:",e),alert("Failed to save quote.")}};return(0,a.jsxs)("div",{className:"space-y-6 max-w-md mx-auto p-4",children:[(0,a.jsx)(O,{}),(0,a.jsxs)("div",{className:"text-center space-y-2 relative",children:[(0,a.jsx)("button",{onClick:()=>M(!0),className:"absolute right-0 top-0 text-gray-400 hover:text-pink-500 transition-colors",children:(0,a.jsx)(r.Z,{size:20})}),(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Lacqr Lens"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Snap a pic, get the price."}),et&&(0,a.jsxs)("p",{className:"text-xs text-amber-600 font-medium animate-pulse",children:["Cooling down... ",es,"s"]})]}),(0,a.jsx)(w.Z,{isOpen:B,onClose:()=>M(!1),context:"lacqr_lens"}),el&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-4 animate-in slide-in-from-top-2",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(i.Z,{className:"text-red-500 mt-0.5 mr-3 flex-shrink-0",size:20}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-red-800 mb-1",children:"Analysis Failed"}),(0,a.jsx)("p",{className:"text-xs text-red-700 break-words mb-3",children:el}),(0,a.jsx)("button",{onClick:()=>{en(null),F({base:{system:"Acrylic",shape:"Square",length:"Short"},addons:{finish:"Glossy",specialtyEffect:"None",classicDesign:"None"},art:{level:null},bling:{density:"None",xlCharmsCount:0,piercingsCount:0},modifiers:{foreignWork:"None",repairsCount:0,soakOffOnly:!1},pedicure:{type:"None",toeArtMatch:!1},estimatedDuration:0,aiDescription:"Manual Configuration"}),H("configure")},className:"text-xs font-bold bg-red-100 text-red-700 px-3 py-2 rounded-lg hover:bg-red-200 transition-colors",children:"Configure Manually"})]}),(0,a.jsx)("button",{onClick:()=>en(null),className:"text-red-400 hover:text-red-600 ml-2",children:(0,a.jsx)(o.Z,{size:16})})]})}),(0,a.jsx)(N.Z,{isVisible:D,onCancel:()=>{P(!1),en("Scan cancelled by user.")}}),"receipt"!==J&&(z?(0,a.jsxs)("div",{className:"relative rounded-3xl overflow-hidden shadow-lg bg-black h-80 group",children:[(0,a.jsx)("div",{className:"w-full h-full overflow-hidden cursor-zoom-in",onClick:()=>{G(e=>1===e?2.5:1)},children:(0,a.jsx)("img",{src:z,alt:"Uploaded",className:"w-full h-full object-contain bg-black transition-all duration-300 ".concat(D?"opacity-50":"opacity-100"),style:{transform:"scale(".concat($,")"),transformOrigin:"center"}})}),!D&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),U(!0)},className:"absolute top-4 left-4 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 backdrop-blur-sm transition-colors z-10",children:(0,a.jsx)(d.Z,{size:20})}),!D&&(0,a.jsx)("button",{onClick:ec,className:"absolute top-4 right-4 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 backdrop-blur-sm transition-colors z-10",children:(0,a.jsx)(o.Z,{size:20})}),!D&&(0,a.jsxs)("div",{className:"absolute bottom-4 right-4 bg-black/50 text-white px-3 py-1 rounded-full text-xs backdrop-blur-sm pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity flex items-center space-x-1",children:[1===$?(0,a.jsx)(d.Z,{size:12}):(0,a.jsx)(x.Z,{size:12}),(0,a.jsx)("span",{children:1===$?"Tap to Zoom":"Tap to Reset"})]}),!D&&R&&(0,a.jsxs)("div",{className:"absolute bottom-4 left-4 right-16 bg-yellow-500/90 backdrop-blur-md p-3 rounded-xl flex items-center text-white shadow-lg animate-in slide-in-from-bottom-2 pointer-events-none",children:[(0,a.jsx)(m.Z,{size:20,className:"mr-3 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-xs font-bold",children:"Image appears blurry. Results may be less accurate."})]})]}):(0,a.jsxs)("label",{className:"border-2 border-dashed border-gray-300 rounded-3xl h-80 flex flex-col items-center justify-center bg-white cursor-pointer hover:border-pink-300 hover:bg-pink-50/50 transition-all group relative overflow-hidden",children:[(0,a.jsx)("input",{type:"file",ref:ei,accept:"image/*",onChange:eo,className:"hidden"}),(0,a.jsx)("div",{className:"w-20 h-20 bg-pink-50 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:(0,a.jsx)(c.Z,{size:32,className:"text-pink-500"})}),(0,a.jsx)("span",{className:"font-medium text-gray-500 group-hover:text-pink-500 transition-colors",children:"Tap to Scan Design"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"or upload from gallery"})]})),"configure"===J&&L&&(0,a.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-bottom-10 fade-in duration-500",children:[L.visual_description&&(0,a.jsxs)("div",{className:"bg-indigo-50 border border-indigo-100 p-4 rounded-xl relative",children:[(0,a.jsx)("h4",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wider mb-2",children:"AI Visual Analysis"}),(0,a.jsxs)("p",{className:"text-sm text-indigo-900 italic mb-3",children:['"',L.visual_description,'"']}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>ee(!0),className:"p-1.5 rounded-lg hover:bg-indigo-100 text-indigo-400 hover:text-indigo-600 transition-colors",title:"Good analysis",children:(0,a.jsx)(u.Z,{size:16})}),(0,a.jsx)("button",{onClick:()=>ee(!0),className:"p-1.5 rounded-lg hover:bg-indigo-100 text-indigo-400 hover:text-indigo-600 transition-colors",title:"Bad analysis",children:(0,a.jsx)(g.Z,{size:16})})]})]}),(0,a.jsx)(S.Z,{initialSelection:L,onUpdate:e=>F(e)}),(0,a.jsxs)("button",{onClick:()=>H("receipt"),className:"w-full py-4 bg-gray-900 text-white rounded-xl font-bold hover:bg-black shadow-lg transition-all flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{children:"Generate Receipt"}),(0,a.jsx)(b.Z,{size:20})]})]}),"receipt"===J&&L&&(0,a.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-10 fade-in duration-500",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-4",children:(0,a.jsxs)("button",{onClick:()=>H("configure"),className:"text-gray-500 hover:text-gray-900 flex items-center gap-1 text-sm font-medium",children:[(0,a.jsx)(h.Z,{size:16})," Back to Edit"]})}),(0,a.jsx)(I,{initialSelection:L,onSaveDraft:ed,onAssignClient:()=>{K("assign"),W(!0)},onCreateClient:()=>{K("create"),W(!0)}})]}),Q&&z&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:()=>U(!1),children:[(0,a.jsx)("button",{onClick:()=>U(!1),className:"absolute top-4 right-4 text-white hover:text-gray-300",children:(0,a.jsx)(o.Z,{size:32})}),(0,a.jsx)("img",{src:z,alt:"Full size",className:"max-w-full max-h-full object-contain rounded-lg",onClick:e=>e.stopPropagation()})]}),(0,a.jsx)(A.Z,{isOpen:V,mode:Y,onClose:()=>W(!1),onClientSelected:ex}),(0,a.jsx)(E.Z,{isOpen:X,onClose:()=>ee(!1),context:"lacqr_lens",aiResult:L})]})}function $(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("div",{className:"p-8 text-center",children:"Loading Lens..."}),children:(0,a.jsx)(T,{})})}},77907:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var a=s(57437),l=s(2265),n=s(69842),r=s(89506),i=s(43257),o=s(74697),c=s(3274);function d(e){let{isOpen:t,onClose:s,onClientSelected:d}=e,{user:x}=(0,i.q)(),[m,u]=(0,l.useState)(""),[g,b]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[f,j]=(0,l.useState)(!1),y=async e=>{if(e.preventDefault(),x.id){j(!0);try{let e={name:m,phone:g,email:h,notes:"",createdAt:new Date},t=await (0,n.addDoc)((0,n.collection)(r.db,"users",x.id,"clients"),e);d&&d({id:t.id,...e}),u(""),b(""),p(""),s()}catch(e){console.error("Error adding client:",e),alert("Failed to add client.")}finally{j(!1)}}};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 space-y-6 animate-in fade-in zoom-in-95 duration-200 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-charcoal",children:"Add New Client"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-charcoal transition-colors",children:(0,a.jsx)(o.Z,{size:24})})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",required:!0,value:m,onChange:e=>u(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50 focus:bg-white transition-colors",placeholder:"e.g. Sarah Johnson",autoFocus:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:g,onChange:e=>b(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50 focus:bg-white transition-colors",placeholder:"(555) 123-4567"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",value:h,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-pink-500 focus:ring-0 bg-gray-50 focus:bg-white transition-colors",placeholder:"sarah@example.com"})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-charcoal text-white py-3 rounded-xl font-bold hover:bg-black transition-colors flex items-center justify-center disabled:opacity-70",children:f?(0,a.jsx)(c.Z,{className:"animate-spin"}):"Create Client"})})]})]})}):null}}},function(e){e.O(0,[4358,9637,2505,7337,9279,742,6704,9144,5623,7138,3442,7750,1943,2971,7023,1744],function(){return e(e.s=574)}),_N_E=e.O()}]);